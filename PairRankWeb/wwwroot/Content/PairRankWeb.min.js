function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv;a=self;b=a.PairRankWeb=a.PairRankWeb||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Operators=d.Operators||{};f=d.Mvu=d.Mvu||{};g=f.App=f.App||{};h=c.Model=c.Model||{};i=c.EndPoint=c.EndPoint||{};j=c.Item=c.Item||{};k=c.Pair=c.Pair||{};l=a.PairRankWeb_JsonEncoder=a.PairRankWeb_JsonEncoder||{};m=a.PairRankWeb_JsonDecoder=a.PairRankWeb_JsonDecoder||{};n=a.PairRankWeb_GeneratedPrintf=a.PairRankWeb_GeneratedPrintf||{};o=a.GeneratedPrintf=a.GeneratedPrintf||{};p=a.PairRankWeb_Templates=a.PairRankWeb_Templates||{};q=a.PairRankWeb_Router=a.PairRankWeb_Router||{};r=d.Obj=d.Obj||{};s=f.Pager=f.Pager||{};t=a.StartupCode$PairRankWeb$Client=a.StartupCode$PairRankWeb$Client||{};u=d.List=d.List||{};v=u.T=u.T||{};w=c.Pages=c.Pages||{};x=d.UI=d.UI||{};y=x.Var=x.Var||{};z=d.Numeric=d.Numeric||{};A=d.ClientSideJson=d.ClientSideJson||{};B=A.Provider=A.Provider||{};C=x.Client=x.Client||{};D=C.Templates=C.Templates||{};E=x.Doc=x.Doc||{};F=d.JavaScript=d.JavaScript||{};G=F.Pervasives=F.Pervasives||{};H=d.Ref=d.Ref||{};I=d.Unchecked=d.Unchecked||{};J=d.Lazy=d.Lazy||{};K=f.Page=f.Page||{};L=x.Templating=x.Templating||{};M=L.Runtime=L.Runtime||{};N=M.Server=M.Server||{};O=N.TemplateInstance=N.TemplateInstance||{};P=d.Arrays=d.Arrays||{};Q=N.ProviderBuilder=N.ProviderBuilder||{};R=N.Handler=N.Handler||{};S=x.Var$1=x.Var$1||{};T=c.Message=c.Message||{};U=x.AttrModule=x.AttrModule||{};V=x.View=x.View||{};W=c.Disabled=c.Disabled||{};X=d.Strings=d.Strings||{};Y=a.Event;Z=a.UIEvent;_0=c.WinnerOfPair=c.WinnerOfPair||{};_1=d.Seq=d.Seq||{};_2=x.Router=x.Router||{};_3=a.EventTarget;_4=a.WindowOrWorkerGlobalScope;_5=F.JS=F.JS||{};_6=a.Object;_7=a.Node;_8=d.Collections=d.Collections||{};_9=_8.Dictionary=_8.Dictionary||{};_=d.Option=d.Option||{};$=x.Elt=x.Elt||{};ba=C.EltUpdater=C.EltUpdater||{};bb=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bc=bb.LazyRecord=bb.LazyRecord||{};bd=x.HtmlModule=x.HtmlModule||{};be=bd.attr=bd.attr||{};bf=a.System=a.System||{};bg=bf.Guid=bf.Guid||{};bh=_8.List=_8.List||{};bi=x.FromView=x.FromView||{};bj=x.Attrs=x.Attrs||{};bk=x.Snap=x.Snap||{};bl=d.Sitelets=d.Sitelets||{};bm=bl.RouterOperators=bl.RouterOperators||{};bn=d.Enumerator=d.Enumerator||{};bo=bn.T=bn.T||{};bp=d.Utils=d.Utils||{};bq=bl.RouterModule=bl.RouterModule||{};br=bl.Route=bl.Route||{};bs=x.Abbrev=x.Abbrev||{};bt=bs.Fresh=bs.Fresh||{};bu=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};bv=_8.HashSet=_8.HashSet||{};bw=x.Docs=x.Docs||{};bx=x.ConcreteVar=x.ConcreteVar||{};by=d.Concurrency=d.Concurrency||{};bz=x.Updates=x.Updates||{};bA=x.DocElemNode=x.DocElemNode||{};bB=x.AttrProxy=x.AttrProxy||{};bC=N.TemplateInitializer=N.TemplateInitializer||{};bD=x.DynamicAttrNode=x.DynamicAttrNode||{};bE=x.CheckedInput=x.CheckedInput||{};bF=bl.Router=bl.Router||{};bG=bl.List=bl.List||{};bH=_8.DictionaryUtil=_8.DictionaryUtil||{};bI=D.Prepare=D.Prepare||{};bJ=d.Slice=d.Slice||{};bK=x.DomUtility=x.DomUtility||{};bL=_8.KeyCollection=_8.KeyCollection||{};bM=a.CharacterData;bN=x.An=x.An||{};bO=C.Settings=C.Settings||{};bP=bs.Mailbox=bs.Mailbox||{};bQ=by.CT=by.CT||{};bR=by.AsyncBody=by.AsyncBody||{};bS=C.Attrs=C.Attrs||{};bT=bS.Dyn=bS.Dyn||{};bU=a.Error;bV=d.InvalidOperationException=d.InvalidOperationException||{};bW=x.Array=x.Array||{};bX=_8.FSharpMap=_8.FSharpMap||{};bY=_8.Map=_8.Map||{};bZ=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};b0=C.Docs=C.Docs||{};b1=b0.RunState=b0.RunState||{};b2=b0.NodeSet=b0.NodeSet||{};b3=x.Anims=x.Anims||{};b4=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};b5=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};b6=by.Scheduler=by.Scheduler||{};b7=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};b8=_8.BalancedTree=_8.BalancedTree||{};b9=b8.Tree=b8.Tree||{};b_=_8.Pair=_8.Pair||{};b$=bl.PathUtil=bl.PathUtil||{};ca=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};cb=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};cc=x.AppendList=x.AppendList||{};cd=_8.HashSetUtil=_8.HashSetUtil||{};ce=d.CancellationTokenSource=d.CancellationTokenSource||{};cf=x.BindVar=x.BindVar||{};cg=x.String=x.String||{};ch=_8.ValueCollection=_8.ValueCollection||{};ci=d.Queue=d.Queue||{};cj=_8.MapUtil=_8.MapUtil||{};ck=x.Easing=x.Easing||{};cl=bs.HashSet=bs.HashSet||{};cm=d.Char=d.Char||{};cn=b0.DomNodes=b0.DomNodes||{};co=d.OperationCanceledException=d.OperationCanceledException||{};cp=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};cq=a.console;cr=a.IntelliFactory;cs=cr&&cr.Runtime;ct=a.JSON;cu=a.Math;cv=a.Date;c.Main=function(){var cw,cx;cw=g.Run(g.withLocalStorage({Encode:l.j(),Decode:m.j()},"PairRankStore",(cx=g.CreatePaged(c.initialModel(),c.Update,c.Render),g.WithCustomRouting(c.router(),function(cy){return cy.EndPoint;},c.Navigate,cx))));D.LoadLocalTemplates("");E.RunById("main",cw);};c.initialModel=function(){t.$cctor();return t.initialModel;};c.Update=function(cw,cx){var cy,cz,cA,cB,cC;return cw.$==1?{$:1,$0:h.New(cx.EndPoint,"",new v({$:1,$0:j.New(cx.NextId,0,cx.PendingItemValue),$1:cx.Items}),cx.NextId+1,cx.PendingCombinations)}:cw.$==3?{$:1,$0:h.New(cx.EndPoint,cw.$0,cx.Items,cx.NextId,cx.PendingCombinations)}:cw.$==2?(cy=cw.$0,{$:1,$0:h.New(cx.EndPoint,cx.PendingItemValue,u.filter(function(cD){return cD.Id!==cy;},cx.Items),cx.NextId,cx.PendingCombinations)}):cw.$==4?{$:1,$0:h.New(i.CompareItems,cx.PendingItemValue,cx.Items,cx.NextId,u.map(function(cD){return k.New(cD[0],cD[1]);},c.createPermutations(cx.Items)))}:cw.$==5?(cz=cw.$0,(cA=u.head(cx.PendingCombinations),(cB=cz.$==1?cA.B:cA.A,(cq.log((((cs.Curried3(function(cD,cE,cF){return cD("Recording option "+n.p(cE)+" from pair "+o.p(cF));}))(a.id))(cz))(cA)),cC=h.New(cx.EndPoint,cx.PendingItemValue,u.map(function(cD){return cD.Id===cB.Id?j.New(cD.Id,cD.Votes+1,cD.Value):cD;},cx.Items),cx.NextId,cx.PendingCombinations),u.length(cx.PendingCombinations)===1?{$:1,$0:h.New(i.Result,cC.PendingItemValue,cC.Items,cC.NextId,cC.PendingCombinations)}:{$:1,$0:h.New(cC.EndPoint,cC.PendingItemValue,cC.Items,cC.NextId,u.tail(cx.PendingCombinations))})))):cw.$==6?{$:1,$0:h.New(i.ItemEntry,cx.PendingItemValue,v.Empty,cx.NextId,v.Empty)}:{$:1,$0:h.New(cw.$0,cx.PendingItemValue,cx.Items,cx.NextId,cx.PendingCombinations)};};c.Render=function(cw){var cx;cx=cw.EndPoint;return cx.$==1?(w.ItemEntry())():cx.$==2?(w.CompareItems())():cx.$==3?(w.Result())():cx.$==4?(w.PrivacyPolicy())():(w.MainPage())();};c.router=function(){t.$cctor();return t.router;};c.Navigate=function(cw,cx){return h.New(cw,cx.PendingItemValue,cx.Items,cx.NextId,cx.PendingCombinations);};c.createPermutations=function(cw){function cx(cy){var cz;return cy.$==1?cy.$1.$==1?(cz=cy.$0,new v({$:1,$0:[cz,cy.$1.$0],$1:cx(new v({$:1,$0:cz,$1:cy.$1.$1}))})):v.Empty:v.Empty;}return _1.fold(function(cy,cz){return u.append(cy,cx(cz));},v.Empty,c.tails(cw));};c.tails=function(cw){var cx;return cw.$==1?(cx=cw.$1,new v({$:1,$0:new v({$:1,$0:cw.$0,$1:cx}),$1:c.tails(cx)})):u.ofArray([v.Empty]);};e.FailWith=function(cw){throw new bU(cw);};e.InvalidOp=function(cw){throw new bV.New(cw);};e.KeyValue=function(cw){return[cw.K,cw.V];};g.CreatePaged=function(cw,cx,cy){function cz(cA,cB){return(new s.New(cy,cA,cB)).get_Doc();}return g.Create(cw,cx,function(cA){return function(cB){return cz(cA,cB);};});};g.WithCustomRouting=function(cw,cx,cy,cz){return g.withRouting(S.Lens(cz.Var,cx,function(cA,cB){return cy(cB,cA);}),cw,cx,cz);};g.Run=function(cw){function cx(cy){cw.Var.UpdateMaybe((cw.Update(cx))(cy));}cw.Init(cx);return(cw.Render(cx))(cw.View);};g.Create=function(cw,cx,cy){function cz(cA,cB,cC){return g.applyAction(cA,cC,cx(cB,cC));}return g.create(cw,cs.Curried3(cz),cy);};g.withRouting=function(cw,cx,cy,cz){return g.New(function(cA){cz.Init(cA);_2.InstallHashInto(cw,cy(cz.Var.Get()),cx);},cz.Var,cz.View,cz.Update,cz.Render);};g.withLocalStorage=function(cw,cx,cy){return g.New(function(cz){var cA;cA=self.localStorage.getItem(cx);if(cA===null)void 0;else try{cy.Var.Set(cw.Decode(ct.parse(cA)));}catch(cB){cq.error("Error deserializing state from local storage",cB);}cy.Init(cz);},cy.Var,V.Map(function(cz){self.localStorage.setItem(cx,ct.stringify(cw.Encode(cz)));return cz;},cy.View),cy.Update,cy.Render);};g.create=function(cw,cx,cy){var cz;cz=S.Create$1(cw);return g.New(a.ignore,cz,cz.get_View(),cx,cy);};g.applyAction=function(cw,cx,cy){function cz(cA,cB){var cC;cC=g.applyAction(cw,cA==null?cx:cA.$0,cB);return cC==null?cA:cC;}return cy.$==1?{$:1,$0:cy.$0}:cy.$==2?{$:1,$0:cy.$0(cx)}:cy.$==3?(cy.$0(cw),null):cy.$==4?(by.Start(cy.$0(cw),null),null):cy.$==5?(((cs.Curried3(_1.fold))(cz))(null))(cy.$0):null;};h.New=function(cw,cx,cy,cz,cA){return{EndPoint:cw,PendingItemValue:cx,Items:cy,NextId:cz,PendingCombinations:cA};};i.CompareItems={$:2};i.Result={$:3};i.ItemEntry={$:1};i.Home={$:0};j.New=function(cw,cx,cy){return{Id:cw,Votes:cx,Value:cy};};k.New=function(cw,cx){return{A:cw,B:cx};};l.j=function(){return l._v?l._v:l._v=(B.EncodeRecord(void 0,[["EndPoint",l.j$1,0],["PendingItemValue",B.Id(),0],["Items",B.EncodeList(B.Id()),0],["NextId",B.Id(),0],["PendingCombinations",B.EncodeList(B.Id()),0]]))();};m.j=function(){return m._v?m._v:m._v=(B.DecodeRecord(void 0,[["EndPoint",m.j$1,0],["PendingItemValue",B.Id(),0],["Items",B.DecodeList(B.Id()),0],["NextId",B.Id(),0],["PendingCombinations",B.DecodeList(B.Id()),0]]))();};n.p=function(cw){return cw.$==1?"B":"A";};o.p=function(cw){return"{"+("A = "+o.p$1(cw.A))+"; "+("B = "+o.p$1(cw.B))+"}";};l.j$1=function(){return l._v$1?l._v$1:l._v$1=(B.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[]],[3,[]],[4,[]]]))();};m.j$1=function(){return m._v$1?m._v$1:m._v$1=(B.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[]],[3,[]],[4,[]]]))();};p.mainpage=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"mainpage"},cw):void 0;};p.itemtemplate=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"itemtemplate"},cw):void 0;};p.itemstemplate=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"itemstemplate"},cw):void 0;};p.itementrypage=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"itementrypage"},cw):void 0;};p.comparisontemplate=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"comparisontemplate"},cw):void 0;};p.resultsitemtemplate=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"resultsitemtemplate"},cw):void 0;};p.resultstemplate=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"resultstemplate"},cw):void 0;};p.privacypolicytemplate=function(cw){D.LoadLocalTemplates("index");return cw?D.NamedTemplate("index",{$:1,$0:"privacypolicytemplate"},cw):void 0;};q.r=function(){return bm.JSUnion(void 0,[[null,[[null,[]]],[]],[null,[[null,["addItems"]]],[]],[null,[[null,["compare"]]],[]],[null,[[null,["result"]]],[]],[null,[[null,["privacy"]]],[]]]);};o.p$1=function(cw){return"{"+("Id = "+bp.prettyPrint(cw.Id))+"; "+("Votes = "+bp.prettyPrint(cw.Votes))+"; "+("Value = "+bp.prettyPrint(cw.Value))+"}";};r=d.Obj=cs.Class({Equals:function(cw){return this===cw;},GetHashCode:function(){return -1;}},null,r);r.New=cs.Ctor(function(){},r);s=f.Pager=cs.Class({get_Doc:function(){return this.container$1;},container$2:function(){var cw;function cx(cy,cz){var cA,cB,cC,cD,cE,cF,cG,cH;cC=cw.render(cz);cD=((cC.Render(d.checkThis(cw["this"][0])))(cw.dispatch))(cw.model);cE=cD.elt;cF=cy.childNodes;for(cG=0,cH=cF.length-1;cG<=cH;cG++)if(cF[cG]!==cE)cF[cG].setAttribute("aria-hidden","true");cE.removeAttribute("aria-hidden");cA=cw.toRemove;cA!=null&&cA.$==1?cA.$0!==cD?(cB=cA.$0,cC.UsesTransition?cB.elt.dataset.wsRemoving="true":cy.removeChild(cB.elt),J.Force(cw.container).RemoveUpdated(cB)):void 0:void 0;!cy.contains(cE)?(cE.setAttribute("aria-hidden","true"),cy.appendChild(cE),J.Force(cw.container).AddUpdated(cD),a.requestAnimationFrame(function(){cE.removeAttribute("aria-hidden");})):void 0;return cw.toRemove=cC.KeepInDom?null:{$:1,$0:cD};}cw=this;return E.Element("div",[bB.Create("class","ws-page-container"),U.DynamicCustom(function(cy){return function(cz){return cx(cy,cz);};},this.model)],[]).ToUpdater();},RemoveIfNeeded:function(cw){if(cw.dataset.wsRemoving==="true"){cw.dataset.wsRemoving="false";this.container$1.elt.removeChild(cw);}}},r,s);s.New=cs.Ctor(function(cw,cx,cy){var cz;cz=this;r.New.call(this);this["this"]=H.New(null);new r.New();this.render=cw;this.dispatch=cx;this.model=cy;this["this"][0]=this;this.toRemove=null;this.container=J.Create(function(){return cz.container$2();});this.container$1=J.Force(this.container);this.init=1;},s);t.$cctor=function(){t.$cctor=a.ignore;t.initialModel=h.New(i.Home,"",v.Empty,0,v.Empty);t.MainPage=K.Single(function(cw){return function(){var cx,cy,cz,cA;return(cx=(cy=new Q.New$1(),(cy.h.push(R.EventQ2(cy.k,"clicknext",function(){return cy.i;},function(){cw({$:0,$0:i.ItemEntry});})),cy)),(cz=R.CompleteHoles(cx.k,cx.h,[]),(cA=new O.New(cz[1],p.mainpage(cz[0])),cx.i=cA,cA))).get_Doc();};},null,null,null);t.ItemEntry=K.Single(function(cw){return function(cx){var cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS;function cT(cU){return{$:3,$0:cU};}return(cy=(cz=(cA=(cB=E.Convert(function(cU){var cV,cW,cX,cY,cZ;return(cV=(cW=(cX=new Q.New$1(),(cX.h.push(R.EventQ2(cX.k,"removeitem",function(){return cX.i;},function(c0){cw({$:2,$0:cU.Id});c0.Event.preventDefault();})),cX)),(cW.h.push({$:1,$0:"value",$1:cU.Value}),cW)),(cY=R.CompleteHoles(cV.k,cV.h,[]),(cZ=new O.New(cY[1],p.itemtemplate(cY[0])),cV.i=cZ,cZ))).get_Doc();},V.Map(function(cU){return cU.Items;},cx)),(cC=(cD=U.DynamicProp("hidden",V.Map(function(cU){return cU.Disabled;},V.Map(function(cU){return W.New(u.length(cU.Items)===0);},cx))),(cE=new Q.New$1(),(cE.h.push({$:3,$0:"itemsheaderattr",$1:cD}),cE))),(cC.h.push({$:0,$0:"itemshole",$1:cB}),cC))),(cF=R.CompleteHoles(cA.k,cA.h,[]),(cG=new O.New(cF[1],p.itemstemplate(cF[0])),cA.i=cG,cG))).get_Doc(),(cH=(cI=(cJ=U.DynamicProp("disabled",V.Map(function(cU){return cU.Disabled;},V.Map(function(cU){return W.New(X.length(X.Trim(cU.PendingItemValue))===0);},cx))),(cK=(cL=(cM=V.Map(function(cU){return cU.PendingItemValue;},cx),(cN=(cO=U.DynamicProp("disabled",V.Map(function(cU){return cU.Disabled;},V.Map(function(cU){return W.New(u.length(cU.Items)<2);},cx))),(cP=(cQ=new Q.New$1(),(cQ.h.push(R.EventQ2(cQ.k,"clicknext",function(){return cQ.i;},function(){cw(T.StartVotingPhase);})),cQ)),(cP.h.push({$:3,$0:"clicknextattr",$1:cO}),cP))),(cN.h.push({$:8,$0:"pendingnewitemvar",$1:new bi.New(cM,function(cU){return cw(cT(cU));})}),cN))),(cL.h.push(R.EventQ2(cL.k,"additem",function(){return cL.i;},function(){cw(T.AddNewItem);})),cL)),(cK.h.push({$:3,$0:"additemattr",$1:cJ}),cK))),(cI.h.push(R.EventQ2(cI.k,"pendingnewitemkeydown",function(){return cI.i;},function(cU){if(cU.Event.key==="Enter"){cw(T.AddNewItem);cU.Event.preventDefault();}})),cI)),(cH.h.push({$:0,$0:"content",$1:cz}),cH))),(cR=R.CompleteHoles(cy.k,cy.h,[["pendingnewitemvar",0]]),(cS=new O.New(cR[1],p.itementrypage(cR[0])),cy.i=cS,cS))).get_Doc();};},null,null,null);t.CompareItems=K.Single(function(cw){return function(cx){var cy,cz,cA,cB,cC,cD,cE,cF;cy=V.Map(function(cG){return u.head(cG.PendingCombinations);},cx);return(cz=(cA=(cB=(cC=(cD=new Q.New$1(),(cD.h.push({$:2,$0:"valuea",$1:V.Map(function(cG){return cG.A.Value;},cy)}),cD)),(cC.h.push({$:2,$0:"valueb",$1:V.Map(function(cG){return cG.B.Value;},cy)}),cC)),(cB.h.push(R.EventQ2(cB.k,"awins",function(){return cB.i;},function(cG){cw({$:5,$0:_0.A});cG.Event.preventDefault();})),cB)),(cA.h.push(R.EventQ2(cA.k,"bwins",function(){return cA.i;},function(cG){cw({$:5,$0:_0.B});cG.Event.preventDefault();})),cA)),(cE=R.CompleteHoles(cz.k,cz.h,[]),(cF=new O.New(cE[1],p.comparisontemplate(cE[0])),cz.i=cF,cF))).get_Doc();};},null,null,null);t.Result=K.Single(function(cw){return function(cx){var cy,cz,cA,cB,cC,cD;return(cy=(cz=(cA=E.Convert(function(cE){var cF,cG,cH,cI,cJ,cK;return(cF=(cG=(function(cL){return function(cM){return cL(a.String(cM));};}(a.id))(cE.Votes),(cH=(cI=new Q.New$1(),(cI.h.push({$:1,$0:"value",$1:cE.Value}),cI)),(cH.h.push({$:1,$0:"votecount",$1:cG}),cH))),(cJ=R.CompleteHoles(cF.k,cF.h,[]),(cK=new O.New(cJ[1],p.resultsitemtemplate(cJ[0])),cF.i=cK,cK))).get_Doc();},V.Map(function(cE){return u.rev(u.sortBy(function(cF){return cF.Votes;},cE.Items));},cx)),(cB=new Q.New$1(),(cB.h.push({$:0,$0:"results",$1:cA}),cB))),(cz.h.push(R.EventQ2(cz.k,"startover",function(){return cz.i;},function(){cw(T.Restart);})),cz)),(cC=R.CompleteHoles(cy.k,cy.h,[]),(cD=new O.New(cC[1],p.resultstemplate(cC[0])),cy.i=cD,cD))).get_Doc();};},null,null,null);t.PrivacyPolicy=K.Single(function(){return function(){var cw,cx,cy;return(cw=new Q.New$1(),(cx=R.CompleteHoles(cw.k,cw.h,[]),(cy=new O.New(cx[1],p.privacypolicytemplate(cx[0])),cw.i=cy,cy))).get_Doc();};},null,null,null);t.router=q.r();};v=u.T=cs.Class({GetEnumerator:function(){return new bo.New(this,null,function(cw){var cx;cx=cw.s;return cx.$==0?false:(cw.c=cx.$0,cw.s=cx.$1,true);},void 0);},GetEnumerator0:function(){return bn.Get(this);}},null,v);v.Empty=new v({$:0});u.filter=function(cw,cx){return u.ofSeq(_1.filter(cw,cx));};u.map=function(cw,cx){var cy,cz,cA,cB,cC;if(cx.$==0)return cx;else{cB=new v({$:1});cy=cB;cz=cx;cA=true;while(cA){cy.$0=cw(cz.$0);cz=cz.$1;cz.$==0?cA=false:cy=(cC=new v({$:1}),cy.$1=cC,cC);}cy.$1=v.Empty;return cB;}};u.head=function(cw){return cw.$==1?cw.$0:u.listEmpty();};u.length=function(cw){var cx,cy;cx=cw;cy=0;while(cx.$==1){cx=u.tail(cx);cy=cy+1;}return cy;};u.tail=function(cw){return cw.$==1?cw.$1:u.listEmpty();};u.sortBy=function(cw,cx){var cy;cy=P.ofList(cx);P.sortInPlaceBy(cw,cy);return u.ofArray(cy);};u.rev=function(cw){var cx,cy;cx=v.Empty;cy=cw;while(cy.$==1){cx=new v({$:1,$0:cy.$0,$1:cx});cy=cy.$1;}return cx;};u.ofSeq=function(cw){var cx,cy,cz,cA,cB,cC;if(cw instanceof v)return cw;else if(cw instanceof a.Array)return u.ofArray(cw);else{cx=bn.Get(cw);try{cz=cx.MoveNext();if(!cz)cy=v.Empty;else{cB=new v({$:1});cA=cB;while(cz){cA.$0=cx.Current();cx.MoveNext()?cA=(cC=new v({$:1}),cA.$1=cC,cC):cz=false;}cA.$1=v.Empty;cy=cB;}return cy;}finally{if(typeof cx=="object"&&"Dispose"in cx)cx.Dispose();}}};u.listEmpty=function(){return e.FailWith("The input list was empty.");};u.iter=function(cw,cx){var cy;cy=cx;while(cy.$==1){cw(u.head(cy));cy=u.tail(cy);}};u.init=function(cw,cx){return u.ofArray(P.init(cw,cx));};u.ofArray=function(cw){var cx,cy,cz;cx=v.Empty;for(cy=P.length(cw)-1,cz=0;cy>=cz;cy--)cx=new v({$:1,$0:P.get(cw,cy),$1:cx});return cx;};u.append=function(cw,cx){var cy,cz,cA,cB,cC;if(cw.$==0)return cx;else if(cx.$==0)return cw;else{cB=new v({$:1});cy=cB;cz=cw;cA=true;while(cA){cy.$0=cz.$0;cz=cz.$1;cz.$==0?cA=false:cy=(cC=new v({$:1}),cy.$1=cC,cC);}cy.$1=cx;return cB;}};w.ItemEntry=function(){t.$cctor();return t.ItemEntry;};w.CompareItems=function(){t.$cctor();return t.CompareItems;};w.Result=function(){t.$cctor();return t.Result;};w.PrivacyPolicy=function(){t.$cctor();return t.PrivacyPolicy;};w.MainPage=function(){t.$cctor();return t.MainPage;};y=x.Var=cs.Class({},r,y);y.New=cs.Ctor(function(){r.New.call(this);},y);g.New=function(cw,cx,cy,cz,cA){return{Init:cw,Var:cx,View:cy,Update:cz,Render:cA};};z.TryParseInt32=function(cw,cx){return z.TryParse(cw,-2147483648,2147483647,cx);};B.EncodeRecord=function(cw,cx){return function(){return function(cy){var cz;function cA(cB,cC,cD){var cE;if(cD===0)cz[cB]=(cC(null))(cy[cB]);else if(cD===1){cE=cy[cB];cE==null?void 0:cz[cB]=(cC(null))(cE.$0);}else if(cD===2){if(cy.hasOwnProperty(cB))cz[cB]=(cC(null))(cy[cB]);}else if(cD===3){if(cy[cB]===void 0)cz[cB]=(cC(null))(cy[cB]);}else e.FailWith("Invalid field option kind");}cz={};P.iter(function(cB){return cA(cB[0],cB[1],cB[2]);},cx);return cz;};};};B.Id=cs.Curried3(function(cw,cx,cy){return cy;});B.EncodeList=cs.Curried3(function(cw,cx,cy){var cz,cA;cz=[];cA=cw();u.iter(function(cB){cz.push(cA(cB));},cy);return cz;});B.DecodeRecord=function(cw,cx){return function(){return function(cy){var cz;function cA(cB,cC,cD){if(cD===0){if(cy.hasOwnProperty(cB))cz[cB]=(cC(null))(cy[cB]);else e.FailWith("Missing mandatory field: "+cB);}else if(cD===1)cz[cB]=cy.hasOwnProperty(cB)?{$:1,$0:(cC(null))(cy[cB])}:null;else if(cD===2){if(cy.hasOwnProperty(cB))cz[cB]=(cC(null))(cy[cB]);}else if(cD===3){if(cy[cB]===void 0)cz[cB]=(cC(null))(cy[cB]);}else e.FailWith("Invalid field option kind");}cz=cw===void 0?{}:new cw();P.iter(function(cB){return cA(cB[0],cB[1],cB[2]);},cx);return cz;};};};B.DecodeList=cs.Curried3(function(cw,cx,cy){var cz;cz=cw();return u.init(P.length(cy),function(cA){return cz(P.get(cy,cA));});});B.EncodeUnion=function(cw,cx,cy){return function(){return function(cz){var cA,cB;function cC(cD,cE,cF,cG){var cH,cI,cJ;if(cD===null){cH=(cF(null))(cz.$0);for(var cK in cH)if(function(cL){cA[cL]=cH[cL];return false;}(cK))break;}else if(cG===0)cA[cE]=(cF(null))(cz[cD]);else if(cG===1){cJ=cz[cD];cJ==null?void 0:cA[cE]=(cF(null))(cJ.$0);}else e.FailWith("Invalid field option kind");}return typeof cz==="object"&&cz!=null?(cA={},(cB=P.get(cy,cz.$),(I.Equals(typeof cx,"string")?cA[cx]=cB[0]:void 0,P.iter(function(cD){return cC(cD[0],cD[1],cD[2],cD[3]);},cB[1]),cA))):cz;};};};B.DecodeUnion=function(cw,cx,cy){return function(){return function(cz){var cA,cB,cE,cF,cG;function cC(cH,cI){return cH===cB;}function cD(cH,cI,cJ,cK){var cL;if(cH===null){cL=(cJ(null))(cz);cI?delete cL[cx]:void 0;cE.$0=cL;}else if(cK===0)cE[cH]=(cJ(null))(cz[cI]);else if(cK===1)cE[cH]=cz.hasOwnProperty(cI)?{$:1,$0:(cJ(null))(cz[cI])}:null;else e.FailWith("Invalid field option kind");}if(typeof cz==="object"&&cz!=null){cE=cw===void 0?{}:new cw();if(I.Equals(typeof cx,"string"))cA=(cB=cz[cx],P.findIndex(function(cH){return cC(cH[0],cH[1]);},cy));else{cF=[void 0];for(var cH in cx)if(function(cI){return cz.hasOwnProperty(cI)&&(cF[0]=cx[cI],true);}(cH))break;cA=cF[0];}cE.$=cA;P.iter(function(cI){return cD(cI[0],cI[1],cI[2],cI[3]);},(P.get(cy,cA))[1]);return cE;}else return cz;};};};D.LoadLocalTemplates=function(cw){!D.LocalTemplatesLoaded()?(D.set_LocalTemplatesLoaded(true),D.LoadNestedTemplates(self.document.body,"")):void 0;D.LoadedTemplates().set_Item(cw,D.LoadedTemplateFile(""));};D.LocalTemplatesLoaded=function(){bu.$cctor();return bu.LocalTemplatesLoaded;};D.set_LocalTemplatesLoaded=function(cw){bu.$cctor();bu.LocalTemplatesLoaded=cw;};D.LoadNestedTemplates=function(cw,cx){var cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL;function cy(cM){var cN,cO;if(!cz.ContainsKey(cM)){cN=(cO=null,[cA.TryGetValue(cM,{get:function(){return cO;},set:function(cP){cO=cP;}}),cO]);cN[0]?(cL.Add(cM),cA.Remove(cM),D.PrepareTemplateStrict(cx,{$:1,$0:cM},cN[1],{$:1,$0:cy})):cq.warn(cL.Contains(cM)?"Encountered loop when instantiating "+cM:"Local template does not exist: "+cM);}}cz=D.LoadedTemplateFile(cx);cA=new _9.New$5();cB=cw.querySelectorAll("[ws-template]");for(cC=0,cD=cB.length-1;cC<=cD;cC++){cE=cB[cC];cF=cE.getAttribute("ws-template").toLowerCase();cE.removeAttribute("ws-template");cA.set_Item(cF,D.FakeRootSingle(cE));}cG=cw.querySelectorAll("[ws-children-template]");for(cH=0,cI=cG.length-1;cH<=cI;cH++){cJ=cG[cH];cK=cJ.getAttribute("ws-children-template").toLowerCase();cJ.removeAttribute("ws-children-template");cA.set_Item(cK,D.FakeRoot(cJ));}cL=new bv.New$3();while(cA.count>0)cy(_1.head(cA.get_Keys()));};D.LoadedTemplates=function(){bu.$cctor();return bu.LoadedTemplates;};D.LoadedTemplateFile=function(cw){var cx,cy,cz;cx=(cy=null,[D.LoadedTemplates().TryGetValue(cw,{get:function(){return cy;},set:function(cA){cy=cA;}}),cy]);return cx[0]?cx[1]:(cz=new _9.New$5(),(D.LoadedTemplates().set_Item(cw,cz),cz));};D.FakeRootSingle=function(cw){var cx,cy,cz,cA;cw.removeAttribute("ws-template");cx=cw.getAttribute("ws-replace");cx===null?void 0:(cw.removeAttribute("ws-replace"),cy=cw.parentNode,I.Equals(cy,null)?void 0:(cz=self.document.createElement(cw.tagName),cz.setAttribute("ws-replace",cx),cy.replaceChild(cz,cw)));cA=self.document.createElement("div");cA.appendChild(cw);return cA;};D.FakeRoot=function(cw){var cx;cx=self.document.createElement("div");while(cw.hasChildNodes())cx.appendChild(cw.firstChild);return cx;};D.PrepareTemplateStrict=function(cw,cx,cy,cz){var cA;function cB(cG,cH){var cI,cJ,cK,cL,cM,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c0,c1,c2,c3,c4,c5,c6,c7,c8;function cN(c9){}while(true)switch(cG){case 0:if(cH!==null){cI=cH.nextSibling;if(I.Equals(cH.nodeType,_7.TEXT_NODE))bI.convertTextNode(cH);else if(I.Equals(cH.nodeType,_7.ELEMENT_NODE))cD(cH);cH=cI;}else return null;break;case 1:cO=bJ.string(cH.nodeName,{$:1,$0:3},null).toLowerCase();cP=(cJ=cO.indexOf("."),cJ===-1?[cw,cO]:[bJ.string(cO,null,{$:1,$0:cJ-1}),bJ.string(cO,{$:1,$0:cJ+1},null)]);cQ=cP[1];cR=cP[0];if(cR!==""&&!D.LoadedTemplates().ContainsKey(cR))return bI.failNotLoaded(cQ);else{if(cR===""&&cz!=null)cz.$0(cQ);cS=D.LoadedTemplates().get_Item(cR);if(!cS.ContainsKey(cQ))return bI.failNotLoaded(cQ);else{cT=cS.get_Item(cQ);cU=cT.cloneNode(true);cV=new bv.New$3();cW=new _9.New$5();cX=cH.attributes;for(cY=0,cZ=cX.length-1;cY<=cZ;cY++){c0=cX.item(cY).name.toLowerCase();cW.set_Item(c0,(c1=cX.item(cY).nodeValue,c1===""?c0:c1.toLowerCase()));!cV.Add(c0)?cq.warn("Hole mapped twice",c0):void 0;}for(c2=0,c3=cH.childNodes.length-1;c2<=c3;c2++){c4=cH.childNodes[c2];I.Equals(c4.nodeType,_7.ELEMENT_NODE)?!cV.Add(c4.nodeName.toLowerCase())?cq.warn("Hole filled twice",cQ):void 0:void 0;}c5=cH.childNodes.length===1&&I.Equals(cH.firstChild.nodeType,_7.TEXT_NODE);if(c5){cL=bI.fillTextHole(cU,cH.firstChild.textContent,cQ);((function(c9){return function(c_){if(c_!=null)c9(c_.$0);};}((cM=function(c9){return function(c_){return c9.Add(c_);};}(cV),function(c9){return cN(cM(c9));})))(cL));}bI.removeHolesExcept(cU,cV);if(!c5){for(c6=0,c7=cH.childNodes.length-1;c6<=c7;c6++){c8=cH.childNodes[c6];I.Equals(c8.nodeType,_7.ELEMENT_NODE)?c8.hasAttributes()?bI.fillInstanceAttrs(cU,c8):cC(cU,c8):void 0;}}bI.mapHoles(cU,cW);bI.fill(cU,cH.parentNode,cH);cH.parentNode.removeChild(cH);return;}}break;}}function cC(cG,cH){var cI,cK,cL;function cJ(cM,cN){var cO;if(cK==="title"&&cH.hasChildNodes()){cO=bK.ParseHTMLIntoFakeRoot(cH.textContent);cH.removeChild(cH.firstChild);while(cO.hasChildNodes())cH.appendChild(cO.firstChild);}else null;cD(cH);return bI.fill(cH,cM,cN);}cK=cH.nodeName.toLowerCase();bK.IterSelector(cG,"[ws-attr-holes]",function(cM){var cN,cO,cP,cQ,cR;cN=X.SplitChars(cM.getAttribute("ws-attr-holes"),[" "],1);for(cO=0,cP=cN.length-1;cO<=cP;cO++){cQ=P.get(cN,cO);cM.setAttribute(cQ,(cR=new a.RegExp("\\${"+cK+"}","ig"),cM.getAttribute(cQ).replace(cR,cH.textContent)));}});cL=cG.querySelector("[ws-hole="+cK+"]");if(I.Equals(cL,null)){cI=cG.querySelector("[ws-replace="+cK+"]");return I.Equals(cI,null)?null:(cJ(cI.parentNode,cI),void cI.parentNode.removeChild(cI));}else{while(cL.hasChildNodes())cL.removeChild(cL.lastChild);cL.removeAttribute("ws-hole");return cJ(cL,null);}}function cD(cG){if(X.StartsWith(cG.nodeName.toLowerCase(),"ws-"))cF(cG);else{bI.convertAttrs(cG);cE(cG.firstChild);}}function cE(cG){return cB(0,cG);}function cF(cG){return cB(1,cG);}cA=(cx==null?"":cx.$0).toLowerCase();D.LoadedTemplateFile(cw).set_Item(cA,cy);cy.hasChildNodes()?(function(cG){var cH,cI,cJ,cK;while(true){cH=cG.querySelector("[ws-template]");if(I.Equals(cH,null)){cI=cG.querySelector("[ws-children-template]");if(I.Equals(cI,null))return null;else{cJ=cI.getAttribute("ws-children-template");cI.removeAttribute("ws-children-template");D.PrepareTemplateStrict(cw,{$:1,$0:cJ},cI,null);cG=cG;}}else{cK=cH.getAttribute("ws-template");(D.PrepareSingleTemplate(cw,{$:1,$0:cK},cH))(null);cG=cG;}}}(cy),cE(cy.firstChild)):void 0;};D.NamedTemplate=function(cw,cx,cy){var cz,cA;cz=(cA=null,[D.LoadedTemplateFile(cw).TryGetValue(cx==null?"":cx.$0,{get:function(){return cA;},set:function(cB){cA=cB;}}),cA]);return cz[0]?D.ChildrenTemplate(cz[1].cloneNode(true),cy):(cq.warn("Local template doesn't exist",cx),E.get_Empty());};D.PrepareSingleTemplate=function(cw,cx,cy){var cz;cz=D.FakeRootSingle(cy);return function(cA){D.PrepareTemplateStrict(cw,cx,cz,cA);};};D.ChildrenTemplate=function(cw,cx){var cy,cz,cA,cB,cC;cy=D.InlineTemplate(cw,_1.append(cx,D.GlobalHoles().get_Values()));cz=cy[1];cA=cy[0];cB=cA.Els;return!I.Equals(cB,null)&&cB.length===1&&(P.get(cB,0)instanceof _7&&(I.Equals(P.get(cB,0).nodeType,_7.ELEMENT_NODE)&&(cC=P.get(cB,0),true)))?$.TreeNode(cA,cz):E.Mk({$:6,$0:cA},cz);};D.TextHoleRE=function(){bu.$cctor();return bu.TextHoleRE;};D.InlineTemplate=function(cw,cx){var cy,cz,cA,cB,cE,cF,cG,cH,cI,cJ,cK;function cC(cL,cM){var cN,cO,cP;cN=bj.Insert(cL,cM);cF.push(bj.Updates(cN));cG.push([cL,cN]);cO=cs.GetOptional(cN.OnAfterRender);return cO==null?null:(cP=cO.$0,void cH.push(function(){cP(cL);}));}function cD(cL){var cM,cN;cM=(cN=null,[cI.TryGetValue(cL,{get:function(){return cN;},set:function(cO){cN=cO;}}),cN]);return cM[0]?cM[1].$==0?{$:1,$0:cM[1].$1}:cM[1].$==1?{$:1,$0:E.TextNode(cM[1].$1)}:cM[1].$==2?{$:1,$0:E.TextView(cM[1].$1)}:cM[1].$==8?{$:1,$0:E.TextView(cM[1].$1.get_View())}:cM[1].$==9?{$:1,$0:E.TextView(V.Map(a.String,cM[1].$1.get_View()))}:cM[1].$==10?{$:1,$0:E.TextView(V.Map(function(cO){return cO.get_Input();},cM[1].$1.get_View()))}:cM[1].$==11?{$:1,$0:E.TextView(V.Map(a.String,cM[1].$1.get_View()))}:cM[1].$==12?{$:1,$0:E.TextView(V.Map(function(cO){return cO.get_Input();},cM[1].$1.get_View()))}:cM[1].$==13?{$:1,$0:E.TextView(V.Map(a.String,cM[1].$1.get_View()))}:(cq.warn("Content hole filled with attribute data",cL),null):null;}cE=[];cF=[];cG=[];cH=[];cI=new _9.New$5();cJ=bn.Get(cx);try{while(cJ.MoveNext()){cK=cJ.Current();cI.set_Item(cK.$0,cK);}}finally{if(typeof cJ=="object"&&"Dispose"in cJ)cJ.Dispose();}cy=bK.ChildrenArray(cw);bK.IterSelector(cw,"[ws-hole]",function(cL){var cM,cN,cO;cO=cL.getAttribute("ws-hole");cL.removeAttribute("ws-hole");while(cL.hasChildNodes())cL.removeChild(cL.lastChild);cM=cD(cO);cM!=null&&cM.$==1?(cN=cM.$0,bw.LinkElement(cL,cN.docNode),cE.push(bA.New(bj.Empty(cL),cN.docNode,null,cL,bt.Int(),null)),cF.push(cN.updates)):void 0;});bK.IterSelector(cw,"[ws-replace]",function(cL){var cM,cN,cO,cP,cQ,cR;cM=cD(cL.getAttribute("ws-replace"));cM!=null&&cM.$==1?(cN=cM.$0,cO=cL.parentNode,cP=self.document.createTextNode(""),cO.replaceChild(cP,cL),cQ=bw.InsertBeforeDelim(cP,cN.docNode),cR=P.tryFindIndex(function(cS){return cL===cS;},cy),cR==null?void 0:P.set(cy,cR.$0,cN.docNode),cE.push(bA.New(bj.Empty(cO),cN.docNode,{$:1,$0:[cQ,cP]},cO,bt.Int(),null)),cF.push(cN.updates)):void 0;});bK.IterSelector(cw,"[ws-attr]",function(cL){var cM,cN,cO;cM=cL.getAttribute("ws-attr");cL.removeAttribute("ws-attr");cN=(cO=null,[cI.TryGetValue(cM,{get:function(){return cO;},set:function(cP){cO=cP;}}),cO]);cN[0]?cN[1].$==3?cC(cL,cN[1].$1):cq.warn("Attribute hole filled with non-attribute data",cM):void 0;});bK.IterSelector(cw,"[ws-on]",function(cL){cC(cL,bB.Concat(P.choose(function(cM){var cN,cO,cP;cN=X.SplitChars(cM,[":"],1);cO=(cP=null,[cI.TryGetValue(P.get(cN,1),{get:function(){return cP;},set:function(cQ){cP=cQ;}}),cP]);return cO[0]?cO[1].$==4?{$:1,$0:U.Handler(P.get(cN,0),cO[1].$1)}:cO[1].$==5?{$:1,$0:bB.Handler(P.get(cN,0),cO[1].$1)}:(cq.warn("Event hole on"+P.get(cN,0)+" filled with non-event data",P.get(cN,1)),null):null;},X.SplitChars(cL.getAttribute("ws-on"),[" "],1))));cL.removeAttribute("ws-on");});bK.IterSelector(cw,"[ws-onafterrender]",function(cL){var cM,cN,cO;cM=cL.getAttribute("ws-onafterrender");cN=(cO=null,[cI.TryGetValue(cM,{get:function(){return cO;},set:function(cP){cO=cP;}}),cO]);cN[0]?cN[1].$==6?(cL.removeAttribute("ws-onafterrender"),cC(cL,U.OnAfterRender(cN[1].$1))):cN[1].$==7?(cL.removeAttribute("ws-onafterrender"),cC(cL,U.OnAfterRender(cN[1].$1))):cq.warn("onafterrender hole filled with non-onafterrender data",cM):void 0;});bK.IterSelector(cw,"[ws-var]",function(cL){var cM,cN,cO;cM=cL.getAttribute("ws-var");cL.removeAttribute("ws-var");cN=(cO=null,[cI.TryGetValue(cM,{get:function(){return cO;},set:function(cP){cO=cP;}}),cO]);cN[0]?cN[1].$==8?cC(cL,U.Value(cN[1].$1)):cN[1].$==9?cC(cL,U.Checked(cN[1].$1)):cN[1].$==10?cC(cL,U.IntValue(cN[1].$1)):cN[1].$==11?cC(cL,U.IntValueUnchecked(cN[1].$1)):cN[1].$==12?cC(cL,U.FloatValue(cN[1].$1)):cN[1].$==13?cC(cL,U.FloatValueUnchecked(cN[1].$1)):cq.warn("Var hole filled with non-Var data",cM):void 0;});bK.IterSelector(cw,"[ws-attr-holes]",function(cL){var cM,cN,cO,cP;cM=new a.RegExp(D.TextHoleRE(),"g");cN=X.SplitChars(cL.getAttribute("ws-attr-holes"),[" "],1);cL.removeAttribute("ws-attr-holes");for(cO=0,cP=cN.length-1;cO<=cP;cO++)(function(){var cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c0,c1,c2;cZ=P.get(cN,cO);c0=cL.getAttribute(cZ);cQ=null;cR=0;c1=[];while(cQ=cM.exec(c0),cQ!==null){c2=bJ.string(c0,{$:1,$0:cR},{$:1,$0:cM.lastIndex-P.get(cQ,0).length-1});cR=cM.lastIndex;c1.push([c2,P.get(cQ,1)]);}cT=bJ.string(c0,{$:1,$0:cR},null);cM.lastIndex=0;cU=P.foldBack(function(c3,c4){return(function(c5){var c6,c7;c6=c5[0];c7=c5[1];return function(c8){var c9,c_,c$,da,db;c9=c8[0];c_=c8[1];c$=(da=(db=null,[cI.TryGetValue(c7,{get:function(){return db;},set:function(dc){db=dc;}}),db]),da[0]?da[1].$==1?{$:0,$0:da[1].$1}:da[1].$==2?{$:1,$0:da[1].$1}:da[1].$==8?{$:1,$0:da[1].$1.get_View()}:da[1].$==9?{$:1,$0:V.Map(a.String,da[1].$1.get_View())}:da[1].$==10?{$:1,$0:V.Map(function(dc){return dc.get_Input();},da[1].$1.get_View())}:da[1].$==11?{$:1,$0:V.Map(a.String,da[1].$1.get_View())}:da[1].$==12?{$:1,$0:V.Map(function(dc){return dc.get_Input();},da[1].$1.get_View())}:da[1].$==13?{$:1,$0:V.Map(a.String,da[1].$1.get_View())}:(cq.warn("Attribute value hole filled with non-text data",c7),{$:0,$0:""}):{$:0,$0:""});return c$.$==1?[c6,new v({$:1,$0:c9===""?c$.$0:V.Map(function(dc){return dc+c9;},c$.$0),$1:c_})]:[c6+c$.$0+c9,c_];};}(c3))(c4);},c1,[cT,v.Empty]);return cC(cL,cU[1].$==1?cU[1].$1.$==1?cU[1].$1.$1.$==1?cU[1].$1.$1.$1.$==0?(cV=cU[0],U.Dynamic(cZ,V.Map3(function(c3,c4,c5){return cV+c3+c4+c5;},cU[1].$0,cU[1].$1.$0,cU[1].$1.$1.$0))):(cW=cU[0],U.Dynamic(cZ,V.Map(function(c3){return cW+X.concat("",c3);},V.Sequence(cU[1])))):(cX=cU[0],U.Dynamic(cZ,V.Map2(function(c3,c4){return cX+c3+c4;},cU[1].$0,cU[1].$1.$0))):cU[0]===""?U.Dynamic(cZ,cU[1].$0):(cY=cU[0],U.Dynamic(cZ,V.Map(function(c3){return cY+c3;},cU[1].$0))):bB.Create(cZ,cU[0]));}());});return[cs.DeleteEmptyFields({Els:cy,Dirty:true,Holes:cE,Attrs:cG,Render:(cz=cH.length==0?null:{$:1,$0:function(cL){P.iter(function(cM){cM(cL);},cH);}},cz?cz.$0:void 0),El:(cA=!I.Equals(cy,null)&&cy.length===1&&(P.get(cy,0)instanceof _7&&(P.get(cy,0)instanceof a.Element&&(cB=P.get(cy,0),true)))?{$:1,$0:cB}:null,cA?cA.$0:void 0)},["Render","El"]),bW.TreeReduce(V.Const(),V.Map2Unit,cF)];};D.GlobalHoles=function(){bu.$cctor();return bu.GlobalHoles;};E=x.Doc=cs.Class({},r,E);E.RunById=function(cw,cx){var cy;cy=self.document.getElementById(cw);I.Equals(cy,null)?e.FailWith("invalid id: "+cw):E.Run(cy,cx);};E.Run=function(cw,cx){bw.LinkElement(cw,cx.docNode);E.RunInPlace(false,cw,cx);};E.RunInPlace=function(cw,cx,cy){var cz;cz=bw.CreateRunState(cx,cy.docNode);V.Sink(bN.get_UseAnimations()||bO.BatchUpdatesEnabled()?bP.StartProcessor(bw.PerformAnimatedUpdate(cw,cz,cy.docNode)):function(){bw.PerformSyncUpdate(cw,cz,cy.docNode);},cy.updates);};E.Element=function(cw,cx,cy){var cz,cA;cz=bB.Concat(cx);cA=E.Concat(cy);return $.New(self.document.createElement(cw),cz,cA);};E.Convert=function(cw,cx){return E.Flatten(V.MapSeqCached(cw,cx));};E.Concat=function(cw){var cx;cx=bW.ofSeqNonCopying(cw);return bW.TreeReduce(E.get_Empty(),E.Append,cx);};E.get_Empty=function(){return E.Mk(null,V.Const());};E.Flatten=function(cw){return E.EmbedView(V.Map(E.Concat,cw));};E.Append=function(cw,cx){return E.Mk({$:0,$0:cw.docNode,$1:cx.docNode},V.Map2Unit(cw.updates,cx.updates));};E.Mk=function(cw,cx){return new E.New(cw,cx);};E.EmbedView=function(cw){var cx;cx=bw.CreateEmbedNode();return E.Mk({$:2,$0:cx},V.Map(a.ignore,V.Bind(function(cy){bw.UpdateEmbedNode(cx,cy.docNode);return cy.updates;},cw)));};E.TextNode=function(cw){return E.Mk({$:5,$0:self.document.createTextNode(cw)},V.Const());};E.TextView=function(cw){var cx;cx=bw.CreateTextNode();return E.Mk({$:4,$0:cx},V.Map(function(cy){bw.UpdateTextNode(cx,cy);},cw));};E.New=cs.Ctor(function(cw,cx){r.New.call(this);this.docNode=cw;this.updates=cx;},E);G.NewFromSeq=function(cw){var cx,cy,cz;cx={};cy=bn.Get(cw);try{while(cy.MoveNext()){cz=cy.Current();cx[cz[0]]=cz[1];}}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}return cx;};H.New=function(cw){return[cw];};I.Equals=function(cw,cx){var cy,cz,cA,cB;if(cw===cx)return true;else{cy=typeof cw;if(cy=="object"){if(cw===null||cw===void 0||cx===null||cx===void 0)return false;else if("Equals"in cw)return cw.Equals(cx);else if(cw instanceof a.Array&&cx instanceof a.Array)return I.arrayEquals(cw,cx);else if(cw instanceof a.Date&&cx instanceof a.Date)return I.dateEquals(cw,cx);else{cz=[true];for(var cC in cw)if(function(cD){cz[0]=!cw.hasOwnProperty(cD)||cx.hasOwnProperty(cD)&&I.Equals(cw[cD],cx[cD]);return!cz[0];}(cC))break;if(cz[0]){for(var cD in cx)if(function(cE){cz[0]=!cx.hasOwnProperty(cE)||cw.hasOwnProperty(cE);return!cz[0];}(cD))break;}return cz[0];}}else return cy=="function"&&("$Func"in cw?cw.$Func===cx.$Func&&cw.$Target===cx.$Target:"$Invokes"in cw&&"$Invokes"in cx&&I.arrayEquals(cw.$Invokes,cx.$Invokes));}};I.arrayEquals=function(cw,cx){var cy,cz;if(P.length(cw)===P.length(cx)){cy=true;cz=0;while(cy&&cz<P.length(cw)){!I.Equals(P.get(cw,cz),P.get(cx,cz))?cy=false:void 0;cz=cz+1;}return cy;}else return false;};I.dateEquals=function(cw,cx){return cw.getTime()===cx.getTime();};I.Compare=function(cw,cx){var cy,cz,cA,cB,cC,cD;if(cw===cx)return 0;else{cz=typeof cw;switch(cz=="function"?1:cz=="boolean"?2:cz=="number"?2:cz=="string"?2:cz=="object"?3:0){case 0:return typeof cx=="undefined"?0:-1;case 1:return e.FailWith("Cannot compare function values.");case 2:return cw<cx?-1:1;case 3:if(cw===null)cA=-1;else if(cx===null)cA=1;else if("CompareTo"in cw)cA=cw.CompareTo(cx);else if("CompareTo0"in cw)cA=cw.CompareTo0(cx);else if(cw instanceof a.Array&&cx instanceof a.Array)cA=I.compareArrays(cw,cx);else if(cw instanceof a.Date&&cx instanceof a.Date)cA=I.compareDates(cw,cx);else{cB=[0];for(var cE in cw)if(function(cF){return!cw.hasOwnProperty(cF)?false:!cx.hasOwnProperty(cF)?(cB[0]=1,true):(cB[0]=I.Compare(cw[cF],cx[cF]),cB[0]!==0);}(cE))break;if(cB[0]===0){for(var cF in cx)if(function(cG){return!cx.hasOwnProperty(cG)?false:!cw.hasOwnProperty(cG)&&(cB[0]=-1,true);}(cF))break;}cA=cB[0];}return cA;}}};I.Hash=function(cw){var cx;cx=typeof cw;return cx=="function"?0:cx=="boolean"?cw?1:0:cx=="number"?cw:cx=="string"?I.hashString(cw):cx=="object"?cw==null?0:cw instanceof a.Array?I.hashArray(cw):I.hashObject(cw):0;};I.compareArrays=function(cw,cx){var cy,cz;if(P.length(cw)<P.length(cx))return -1;else if(P.length(cw)>P.length(cx))return 1;else{cy=0;cz=0;while(cy===0&&cz<P.length(cw)){cy=I.Compare(P.get(cw,cz),P.get(cx,cz));cz=cz+1;}return cy;}};I.compareDates=function(cw,cx){return I.Compare(cw.getTime(),cx.getTime());};I.hashString=function(cw){var cx,cy,cz;if(cw===null)return 0;else{cx=5381;for(cy=0,cz=cw.length-1;cy<=cz;cy++)cx=I.hashMix(cx,cw[cy].charCodeAt());return cx;}};I.hashArray=function(cw){var cx,cy,cz;cx=-34948909;for(cy=0,cz=P.length(cw)-1;cy<=cz;cy++)cx=I.hashMix(cx,I.Hash(P.get(cw,cy)));return cx;};I.hashObject=function(cw){var cx,cy;if("GetHashCode"in cw)return cw.GetHashCode();else{cx=[0];for(var cz in cw)if(function(cA){cx[0]=I.hashMix(I.hashMix(cx[0],I.hashString(cA)),I.Hash(cw[cA]));return false;}(cz))break;return cx[0];}};I.hashMix=function(cw,cx){return(cw<<5)+cw+cx;};J.Create=function(cw){return bc.New(false,cw,J.forceLazy);};J.Force=function(cw){return cw.f();};J.forceLazy=function(){var cw;cw=this.v();this.c=true;this.v=cw;this.f=J.cachedLazy;return cw;};J.cachedLazy=function(){return this.v;};J.CreateFromValue=function(cw){return bc.New(true,cw,J.cachedLazy);};K.Single=function(cw,cx,cy,cz){return K.Reactive(a.ignore,function(cA,cB,cC){return((function(){return cw;}(cA))(cB))(cC);},cx,cy,cz);};K.Reactive=function(cw,cx,cy,cz,cA){var cB;function cC(cD,cE,cF,cG){var cH,cI,cJ,cK,cL;cH=cw(cD);cI=(cJ=null,[cB.TryGetValue(cH,{get:function(){return cJ;},set:function(cM){cJ=cM;}}),cJ]);return cI[0]?(S.Set(cI[1][0],cD),cI[1][1]):(cK=S.Create$1(cD),(cL=E.Element("div",[bB.Create("class","ws-page"),cy==null?bj.EmptyAttr():bB.Concat(cy.$0),U.Handler("transitionend",function(cM){return function(){return cE.RemoveIfNeeded(cM);};})],[cx(cH,cF,cG)]),(cB.set_Item(cH,[cK,cL]),cL)));}cB=new _9.New$5();return function(cD){return K.New(cs.Curried(cC,3,[cD]),cz==null?false:cz.$0,cA==null?false:cA.$0);};};K.New=function(cw,cx,cy){return{Render:cw,KeepInDom:cx,UsesTransition:cy};};O=N.TemplateInstance=cs.Class({get_Doc:function(){return this.doc;}},r,O);O.New=cs.Ctor(function(cw,cx){r.New.call(this);this.doc=cx;this.allVars=cw.$==0?cw.$0:e.FailWith("Should not happen");},O);P.get=function(cw,cx){P.checkBounds(cw,cx);return cw[cx];};d.checkThis=function(cw){return I.Equals(cw,null)?e.InvalidOp("The initialization of an object or value resulted in an object or value being accessed recursively before it was fully initialized."):cw;};P.length=function(cw){return cw.dims===2?cw.length*cw.length:cw.length;};P.checkBounds=function(cw,cx){if(cx<0||cx>=cw.length)e.FailWith("Index was outside the bounds of the array.");};P.set=function(cw,cx,cy){P.checkBounds(cw,cx);cw[cx]=cy;};Q=N.ProviderBuilder=cs.Class({},r,Q);Q.New$1=cs.Ctor(function(){var cw;r.New.call(this);this.i=null;this.k=(cw=bg.NewGuid(),a.String(cw));this.h=[];cs.SetOptional(this,"s",null);},Q);R.EventQ2=function(cw,cx,cy,cz){return{$:5,$0:cx,$1:function(cA){return function(cB){return cz({Vars:cy(),Target:cA,Event:cB});};}};};R.CompleteHoles=function(cw,cx,cy){var cA,cB,cC,cD,cE;function cz(cF,cG){var cH;return cB.Contains(cF)?null:(cH=cG===0?bC.GetOrAddHoleFor(cw,cF,function(){return{$:8,$0:cF,$1:S.Create$1("")};}):cG===1?bC.GetOrAddHoleFor(cw,cF,function(){return{$:13,$0:cF,$1:S.Create$1(0)};}):cG===2?bC.GetOrAddHoleFor(cw,cF,function(){return{$:9,$0:cF,$1:S.Create$1(false)};}):e.FailWith("Invalid value type"),(cA.set_Item(cF,cH),{$:1,$0:cH}));}cA=new _9.New$5();cB=new bv.New$3();cC=bn.Get(cx);try{while(cC.MoveNext()){cD=cC.Current();cE=cD.$0;cB.Add(cE);cA.set_Item(cE,cD);}}finally{if(typeof cC=="object"&&"Dispose"in cC)cC.Dispose();}return[_1.append(cx,P.choose(function(cF){return cz(cF[0],cF[1]);},cy)),{$:0,$0:cA}];};S=x.Var$1=cs.Class({},r,S);S.Lens=function(cw,cx,cy){var cz,cA,cB;cz=bt.Id();cA=V.Map(cx,cw.get_View());cB=new y({Get:function(){return cx(cw.Get());},Set:function(cC){return cw.Update(function(cD){return cy(cD,cC);});},SetFinal:function(cC){return this.Set(cC);},Update:function(cC){return cw.Update(function(cD){return cy(cD,cC(cx(cD)));});},UpdateMaybe:function(cC){return cw.UpdateMaybe(function(cD){var cE;cE=cC(cx(cD));return cE==null?null:{$:1,$0:cy(cD,cE.$0)};});},get_View:function(){return cA;},get_Id:function(){return cz;}});y.New.call(cB);return cB;};S.Create$1=function(cw){return new bx.New(false,bk.New({$:2,$0:cw,$1:[]}),cw);};S.Set=function(cw,cx){cw.Set(cx);};T.StartVotingPhase={$:4};T.AddNewItem={$:1};T.Restart={$:6};U.DynamicProp=function(cw,cx){return bj.Dynamic(cx,function(cy){return function(cz){cy[cw]=cz;};});};U.DynamicCustom=function(cw,cx){return bj.Dynamic(cx,cw);};U.Handler=function(cw,cx){return bj.Static(function(cy){cy.addEventListener(cw,function(cz){return(cx(cy))(cz);},false);});};U.OnAfterRender=function(cw){return new bB({$:4,$0:cw});};U.Value=function(cw){var cx;cx=(((cf.StringApply())(cw))(bj.Static))(function(cy){return U.DynamicCustom(cy,cw.get_View());});return bB.Append(cx[0],cx[1]);};U.Checked=function(cw){var cx;cx=(((cf.BoolCheckedApply())(cw))(bj.Static))(function(cy){return U.DynamicCustom(cy,cw.get_View());});return bB.Append(cx[0],cx[1]);};U.IntValue=function(cw){var cx;cx=(((cf.IntApplyChecked())(cw))(bj.Static))(function(cy){return U.DynamicCustom(cy,cw.get_View());});return bB.Append(cx[0],cx[1]);};U.IntValueUnchecked=function(cw){var cx;cx=(((cf.IntApplyUnchecked())(cw))(bj.Static))(function(cy){return U.DynamicCustom(cy,cw.get_View());});return bB.Append(cx[0],cx[1]);};U.FloatValue=function(cw){var cx;cx=(((cf.FloatApplyChecked())(cw))(bj.Static))(function(cy){return U.DynamicCustom(cy,cw.get_View());});return bB.Append(cx[0],cx[1]);};U.FloatValueUnchecked=function(cw){var cx;cx=(((cf.FloatApplyUnchecked())(cw))(bj.Static))(function(cy){return U.DynamicCustom(cy,cw.get_View());});return bB.Append(cx[0],cx[1]);};U.Dynamic=function(cw,cx){return bj.Dynamic(cx,function(cy){return function(cz){return cy.setAttribute(cw,cz);};});};V.Map=function(cw,cx){return V.CreateLazy(function(){return bk.Map(cw,cx());});};V.CreateLazy=function(cw){var cx;cx={c:null,o:cw};return function(){var cy,cz;cy=cx.c;return cy===null?(cy=cx.o(),cx.c=cy,(cz=cy.s,cz!=null&&cz.$==0)?cx.o=null:bk.WhenObsoleteRun(cy,function(){cx.c=null;}),cy):cy;};};V.Sink=function(cw,cx){function cy(){bk.WhenRun(cx(),cw,function(){by.scheduler().Fork(cy);});}by.scheduler().Fork(cy);};V.TryGet=function(cw){return bk.TryGet(cw());};V.MapSeqCached=function(cw,cx){return V.MapSeqCachedBy(a.id,cw,cx);};V.Get=function(cw,cx){var cy;function cz(){bk.WhenRun(cx(),function(cA){if(!cy[0]){cy[0]=true;cw(cA);}},function(){if(!cy[0])cz();});}cy=[false];cz();};V.Map2Unit=function(cw,cx){return V.CreateLazy(function(){return bk.Map2Unit(cw(),cx());});};V.BindInner=function(cw,cx){return V.JoinInner(V.Map(cw,cx));};V.Const=function(cw){var cx;cx=bk.New({$:0,$0:cw});return function(){return cx;};};V.MapSeqCachedBy=function(cw,cx,cy){var cz;cz=[new _9.New$5()];return V.Map(function(cA){var cB,cC,cD;cB=cz[0];cC=new _9.New$5();cD=bW.mapInPlace(function(cE){var cF,cG;cF=cw(cE);cG=cB.ContainsKey(cF)?cB.get_Item(cF):cx(cE);cC.set_Item(cF,cG);return cG;},P.ofSeq(cA));cz[0]=cC;return cD;},cy);};V.JoinInner=function(cw){return V.CreateLazy(function(){return bk.JoinInner(cw());});};V.Map3=function(cw,cx,cy,cz){return V.CreateLazy(function(){return bk.Map3(cw,cx(),cy(),cz());});};V.Sequence=function(cw){return V.CreateLazy(function(){return bk.Sequence(_1.map(function(cx){return cx();},cw));});};V.Map2=function(cw,cx,cy){return V.CreateLazy(function(){return bk.Map2(cw,cx(),cy());});};V.Bind=function(cw,cx){return V.Join(V.Map(cw,cx));};V.Join=function(cw){return V.CreateLazy(function(){return bk.Join(cw());});};W.New=function(cw){return{Disabled:cw};};X.length=function(cw){return X.protect(cw).length;};X.Trim=function(cw){return cw.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};X.protect=function(cw){return cw===null?"":cw;};X.concat=function(cw,cx){return P.ofSeq(cx).join(cw);};X.StartsWith=function(cw,cx){return cw.substring(0,cx.length)==cx;};X.SplitChars=function(cw,cx,cy){return X.Split(cw,new a.RegExp("["+X.RegexEscape(cx.join(""))+"]"),cy);};X.Substring=function(cw,cx,cy){return cw.substr(cx,cy);};X.Split=function(cw,cx,cy){return cy===1?P.filter(function(cz){return cz!=="";},X.SplitWith(cw,cx)):X.SplitWith(cw,cx);};X.RegexEscape=function(cw){return cw.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};X.SplitWith=function(cw,cx){return cw.split(cx);};X.forall=function(cw,cx){return _1.forall(cw,X.protect(cx));};X.IsNullOrEmpty=function(cw){return cw==null||cw=="";};X.Join=function(cw,cx){return cx.join(cw);};_0.A={$:0};_0.B={$:1};_1.filter=function(cw,cx){return{GetEnumerator:function(){var cy;cy=bn.Get(cx);return new bo.New(null,null,function(cz){var cA,cB,cC;cA=cy.MoveNext();cB=cy.Current();cC=false;while(cA)if(cw(cB)){cz.c=cB;cC=true;cA=false;}else if(cy.MoveNext())cB=cy.Current();else cA=false;return cC;},function(){cy.Dispose();});}};};_1.fold=function(cw,cx,cy){var cz,cA;cz=cx;cA=bn.Get(cy);try{while(cA.MoveNext())cz=cw(cz,cA.Current());return cz;}finally{if(typeof cA=="object"&&"Dispose"in cA)cA.Dispose();}};_1.head=function(cw){var cx;cx=bn.Get(cw);try{return cx.MoveNext()?cx.Current():_1.insufficient();}finally{if(typeof cx=="object"&&"Dispose"in cx)cx.Dispose();}};_1.append=function(cw,cx){return{GetEnumerator:function(){var cy,cz;cy=bn.Get(cw);cz=[true];return new bo.New(cy,null,function(cA){var cB;return cA.s.MoveNext()?(cA.c=cA.s.Current(),true):(cB=cA.s,!I.Equals(cB,null)?cB.Dispose():void 0,cA.s=null,cz[0]&&(cz[0]=false,cA.s=bn.Get(cx),cA.s.MoveNext()?(cA.c=cA.s.Current(),true):(cA.s.Dispose(),cA.s=null,false)));},function(cA){var cB;cB=cA.s;!I.Equals(cB,null)?cB.Dispose():void 0;});}};};_1.iteri=function(cw,cx){var cy,cz;cy=0;cz=bn.Get(cx);try{while(cz.MoveNext()){cw(cy,cz.Current());cy=cy+1;}}finally{if(typeof cz=="object"&&"Dispose"in cz)cz.Dispose();}};_1.collect=function(cw,cx){return _1.concat(_1.map(cw,cx));};_1.indexed=function(cw){return _1.mapi(function(cx,cy){return[cx,cy];},cw);};_1.map=function(cw,cx){return{GetEnumerator:function(){var cy;cy=bn.Get(cx);return new bo.New(null,null,function(cz){return cy.MoveNext()&&(cz.c=cw(cy.Current()),true);},function(){cy.Dispose();});}};};_1.tryFindIndex=function(cw,cx){var cy,cz,cA;cy=bn.Get(cx);try{cz=true;cA=0;while(cz&&cy.MoveNext())if(cw(cy.Current()))cz=false;else cA=cA+1;return cz?null:{$:1,$0:cA};}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}};_1.tryPick=function(cw,cx){var cy,cz;cy=bn.Get(cx);try{cz=null;while(I.Equals(cz,null)&&cy.MoveNext())cz=cw(cy.Current());return cz;}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}};_1.concat=function(cw){return{GetEnumerator:function(){var cx;cx=bn.Get(cw);return new bo.New(null,null,function(cy){var cz;while(true){cz=cy.s;if(I.Equals(cz,null)){if(cx.MoveNext()){cy.s=bn.Get(cx.Current());cy=cy;}else{cx.Dispose();return false;}}else if(cz.MoveNext()){cy.c=cz.Current();return true;}else{cy.Dispose();cy.s=null;cy=cy;}}},function(cy){var cz;cz=cy.s;!I.Equals(cz,null)?cz.Dispose():void 0;!I.Equals(cx,null)?cx.Dispose():void 0;});}};};_1.mapi=function(cw,cx){return _1.map2(cw,_1.initInfinite(a.id),cx);};_1.map2=function(cw,cx,cy){return{GetEnumerator:function(){var cz,cA;cz=bn.Get(cx);cA=bn.Get(cy);return new bo.New(null,null,function(cB){return cz.MoveNext()&&cA.MoveNext()&&(cB.c=cw(cz.Current(),cA.Current()),true);},function(){cz.Dispose();cA.Dispose();});}};};_1.initInfinite=function(cw){return{GetEnumerator:function(){return new bo.New(0,null,function(cx){cx.c=cw(cx.s);cx.s=cx.s+1;return true;},void 0);}};};_1.forall2=function(cw,cx,cy){return!_1.exists2(function(cz,cA){return!cw(cz,cA);},cx,cy);};_1.iter=function(cw,cx){var cy;cy=bn.Get(cx);try{while(cy.MoveNext())cw(cy.Current());}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}};_1.exists2=function(cw,cx,cy){var cz,cA,cB,cC;cz=bn.Get(cx);try{cB=bn.Get(cy);try{cC=false;while(!cC&&cz.MoveNext()&&cB.MoveNext())cC=cw(cz.Current(),cB.Current());cA=cC;}finally{if(typeof cB=="object"&&"Dispose"in cB)cB.Dispose();}return cA;}finally{if(typeof cz=="object"&&"Dispose"in cz)cz.Dispose();}};_1.compareWith=function(cw,cx,cy){var cz,cA,cB,cC,cD;cz=bn.Get(cx);try{cB=bn.Get(cy);try{cC=0;cD=true;while(cD&&cC===0)if(cz.MoveNext())cC=cB.MoveNext()?cw(cz.Current(),cB.Current()):1;else if(cB.MoveNext())cC=-1;else cD=false;cA=cC;}finally{if(typeof cB=="object"&&"Dispose"in cB)cB.Dispose();}return cA;}finally{if(typeof cz=="object"&&"Dispose"in cz)cz.Dispose();}};_1.delay=function(cw){return{GetEnumerator:function(){return bn.Get(cw());}};};_1.distinctBy=function(cw,cx){return{GetEnumerator:function(){var cy,cz;cy=bn.Get(cx);cz=new bv.New$3();return new bo.New(null,null,function(cA){var cB,cC;if(cy.MoveNext()){cB=cy.Current();cC=cz.Add(cw(cB));while(!cC&&cy.MoveNext()){cB=cy.Current();cC=cz.Add(cw(cB));}return cC&&(cA.c=cB,true);}else return false;},function(){cy.Dispose();});}};};_1.max=function(cw){var cx,cy,cz;cx=bn.Get(cw);try{if(!cx.MoveNext())_1.seqEmpty();cy=cx.Current();while(cx.MoveNext()){cz=cx.Current();I.Compare(cz,cy)===1?cy=cz:void 0;}return cy;}finally{if(typeof cx=="object"&&"Dispose"in cx)cx.Dispose();}};_1.forall=function(cw,cx){return!_1.exists(function(cy){return!cw(cy);},cx);};_1.distinct=function(cw){return _1.distinctBy(a.id,cw);};_1.seqEmpty=function(){return e.FailWith("The input sequence was empty.");};_1.unfold=function(cw,cx){return{GetEnumerator:function(){return new bo.New(cx,null,function(cy){var cz;cz=cw(cy.s);return cz==null?false:(cy.c=cz.$0[0],cy.s=cz.$0[1],true);},void 0);}};};_1.exists=function(cw,cx){var cy,cz;cy=bn.Get(cx);try{cz=false;while(!cz&&cy.MoveNext())cz=cw(cy.Current());return cz;}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}};_2.InstallHashInto=function(cw,cx,cy){function cz(cC){return bq.Parse(cy,br.FromHash(cC,{$:1,$0:true}));}function cA(){return _2.getCurrentHash(cz,cx);}function cB(cC){if(!I.Equals(cw.Get(),cC))cw.Set(cC);}cB(cA());self.addEventListener("popstate",function(){return cB(cA());},false);self.addEventListener("hashchange",function(){return cB(cA());},false);self.document.body.addEventListener("click",function(cC){var cD,cE,cF;cD=(cE=_2.findLinkHref(cC.target),cE==null?null:(cF=cE.$0,X.StartsWith(cF,"#")?cz(cF):null));return cD==null?null:(cB(cD.$0),cC.preventDefault());},false);V.Sink(function(cC){var cD;if(!I.Equals(cC,cA())){cD=bq.HashLink(cy,cC);self.history.pushState(null,null,cD);}},cw.get_View());};_2.getCurrentHash=function(cw,cx){var cy,cz;cy=self.location.hash;cz=cw(cy);return cz==null?((function(cA){return function(cB){return cA("Failed to parse route: "+bp.toSafe(cB));};}(function(cA){cq.log(cA);}))(cy),cx):cz.$0;};_2.findLinkHref=function(cw){while(true)if(cw.tagName==="A")return _.ofObj(cw.getAttribute("href"));else if(cw===self.document.body)return null;else cw=cw.parentNode;};V=x.View=cs.Class({},null,V);_5.GetFields=function(cw){var cx,cy;cx=[];for(var cz in cw)cx.push([cz,cw[cz]]);return cx;};_5.GetFieldValues=function(cw){var cx,cy;cx=[];for(var cz in cw)cx.push(cw[cz]);return cx;};P.iter=function(cw,cx){var cy,cz;for(cy=0,cz=cx.length-1;cy<=cz;cy++)cw(cx[cy]);};P.ofList=function(cw){var cx,cy;cy=[];cx=cw;while(!(cx.$==0)){cy.push(u.head(cx));cx=u.tail(cx);}return cy;};P.sortInPlaceBy=function(cw,cx){P.mapInPlace(function(cy){return cy[0];},P.mapiInPlace(function(cy,cz){return[cz,[cw(cz),cy]];},cx).sort(function(cy,cz){return I.Compare(cy[1],cz[1]);}));};P.findIndex=function(cw,cx){var cy;cy=P.tryFindIndex(cw,cx);return cy==null?e.FailWith("KeyNotFoundException"):cy.$0;};P.init=function(cw,cx){var cy,cz,cA;cw<0?e.FailWith("Negative size given."):null;cy=new a.Array(cw);for(cz=0,cA=cw-1;cz<=cA;cz++)cy[cz]=cx(cz);return cy;};P.filter=function(cw,cx){var cy,cz,cA;cy=[];for(cz=0,cA=cx.length-1;cz<=cA;cz++)if(cw(cx[cz]))cy.push(cx[cz]);return cy;};P.choose=function(cw,cx){var cy,cz,cA,cB;cy=[];for(cz=0,cA=cx.length-1;cz<=cA;cz++){cB=cw(cx[cz]);cB==null?void 0:cy.push(cB.$0);}return cy;};P.map2=function(cw,cx,cy){var cz,cA,cB;P.checkLength(cx,cy);cz=new a.Array(cy.length);for(cA=0,cB=cy.length-1;cA<=cB;cA++)cz[cA]=cw(cx[cA],cy[cA]);return cz;};P.forall=function(cw,cx){var cy,cz,cA,cB;cy=true;cz=0;cB=P.length(cx);while(cy&&cz<cB)if(cw(cx[cz]))cz=cz+1;else cy=false;return cy;};P.map=function(cw,cx){var cy,cz,cA;cy=new a.Array(cx.length);for(cz=0,cA=cx.length-1;cz<=cA;cz++)cy[cz]=cw(cx[cz]);return cy;};P.tryFindIndex=function(cw,cx){var cy,cz;cy=null;cz=0;while(cz<cx.length&&cy==null){cw(cx[cz])?cy={$:1,$0:cz}:void 0;cz=cz+1;}return cy;};P.exists=function(cw,cx){var cy,cz,cA,cB;cy=false;cz=0;cB=P.length(cx);while(!cy&&cz<cB)if(cw(cx[cz]))cy=true;else cz=cz+1;return cy;};P.tryPick=function(cw,cx){var cy,cz,cA;cy=null;cz=0;while(cz<cx.length&&cy==null){cA=cw(cx[cz]);cA!=null&&cA.$==1?cy=cA:void 0;cz=cz+1;}return cy;};P.checkLength=function(cw,cx){if(cw.length!==cx.length)e.FailWith("The arrays have different lengths.");};P.foldBack=function(cw,cx,cy){var cz,cA,cB,cC,cD;cz=cy;cB=cx.length;for(cC=1,cD=cB;cC<=cD;cC++)cz=cw(cx[cB-cC],cz);return cz;};P.ofSeq=function(cw){var cx,cy;if(cw instanceof a.Array)return cw.slice();else if(cw instanceof v)return P.ofList(cw);else{cx=[];cy=bn.Get(cw);try{while(cy.MoveNext())cx.push(cy.Current());return cx;}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}}};P.pick=function(cw,cx){var cy;cy=P.tryPick(cw,cx);return cy==null?e.FailWith("KeyNotFoundException"):cy.$0;};P.concat=function(cw){return a.Array.prototype.concat.apply([],P.ofSeq(cw));};P.sortInPlace=function(cw){P.mapInPlace(function(cx){return cx[0];},P.mapiInPlace(function(cx,cy){return[cy,cx];},cw).sort(I.Compare));};P.create=function(cw,cx){var cy,cz,cA;cy=new a.Array(cw);for(cz=0,cA=cw-1;cz<=cA;cz++)cy[cz]=cx;return cy;};_9=_8.Dictionary=cs.Class({set_Item:function(cw,cx){this.set(cw,cx);},ContainsKey:function(cw){var cx,cy;cx=this;cy=this.data[this.hash(cw)];return cy==null?false:P.exists(function(cz){return cx.equals.apply(null,[(e.KeyValue(cz))[0],cw]);},cy);},TryGetValue:function(cw,cx){var cy,cz,cA;cy=this;cz=this.data[this.hash(cw)];return cz==null?false:(cA=P.tryPick(function(cB){var cC;cC=e.KeyValue(cB);return cy.equals.apply(null,[cC[0],cw])?{$:1,$0:cC[1]}:null;},cz),cA!=null&&cA.$==1&&(cx.set(cA.$0),true));},Remove:function(cw){return this.remove(cw);},get_Keys:function(){return new bL.New(this);},set:function(cw,cx){var cy,cz,cA,cB;cy=this;cz=this.hash(cw);cA=this.data[cz];cA==null?(this.count=this.count+1,this.data[cz]=new a.Array({K:cw,V:cx})):(cB=P.tryFindIndex(function(cC){return cy.equals.apply(null,[(e.KeyValue(cC))[0],cw]);},cA),cB==null?(this.count=this.count+1,cA.push({K:cw,V:cx})):cA[cB.$0]={K:cw,V:cx});},remove:function(cw){var cx,cy,cz,cA;cx=this;cy=this.hash(cw);cz=this.data[cy];return cz==null?false:(cA=P.filter(function(cB){return!cx.equals.apply(null,[(e.KeyValue(cB))[0],cw]);},cz),P.length(cA)<cz.length&&(this.count=this.count-1,this.data[cy]=cA,true));},get_Item:function(cw){return this.get(cw);},get:function(cw){var cx,cy;cx=this;cy=this.data[this.hash(cw)];return cy==null?bH.notPresent():P.pick(function(cz){var cA;cA=e.KeyValue(cz);return cx.equals.apply(null,[cA[0],cw])?{$:1,$0:cA[1]}:null;},cy);},get_Values:function(){return new ch.New(this);},GetEnumerator:function(){return bn.Get0(this);},GetEnumerator0:function(){return bn.Get0(P.concat(_5.GetFieldValues(this.data)));}},r,_9);_9.New$5=cs.Ctor(function(){_9.New$6.call(this,[],I.Equals,I.Hash);},_9);_9.New$6=cs.Ctor(function(cw,cx,cy){var cz,cA;r.New.call(this);this.equals=cx;this.hash=cy;this.count=0;this.data=[];cz=bn.Get(cw);try{while(cz.MoveNext()){cA=cz.Current();this.set(cA.K,cA.V);}}finally{if(typeof cz=="object"&&"Dispose"in cz)cz.Dispose();}},_9);_.ofObj=function(cw){return cw==null?null:{$:1,$0:cw};};$=x.Elt=cs.Class({ToUpdater:function(){var cw,cx,cy;return new ba.New((cw=this.docNode$1,cw!=null&&cw.$==1?cs.DeleteEmptyFields({Els:[this.elt],Dirty:true,Holes:[],Attrs:[[this.elt,cw.$0.Attr]],Render:(cx=null,cx?cx.$0:void 0),El:(cy={$:1,$0:this.elt},cy?cy.$0:void 0)},["Render","El"]):cw!=null&&cw.$==6?cw.$0:e.FailWith("Invalid docNode in Elt")),this.updates$1,this.elt,this.rvUpdates,S.Create$1([]));}},E,$);$.New=function(cw,cx,cy){var cz,cA;cz=bw.CreateElemNode(cw,cx,cy.docNode);cA=bz.Create(cy.updates);return new $.New$1({$:1,$0:cz},V.Map2Unit(bj.Updates(cz.Attr),cA.v),cw,cA);};$.TreeNode=function(cw,cx){var cy,cz;function cA(cB){return cB[1];}cy=bz.Create(cx);return new $.New$1({$:6,$0:cw},V.Map2Unit((cz=P.map(function(cB){return bj.Updates(cA(cB));},cw.Attrs),bW.TreeReduce(V.Const(),V.Map2Unit,cz)),cy.v),P.get(cw.Els,0),cy);};$.New$1=cs.Ctor(function(cw,cx,cy,cz){E.New.call(this,cw,cx);this.docNode$1=cw;this.updates$1=cx;this.elt=cy;this.rvUpdates=cz;},$);ba=C.EltUpdater=cs.Class({RemoveUpdated:function(cw){var cx,cy;function cz(cA){return cA!==cy;}cx=cw.docNode;cx!=null&&cx.$==1?(cy=cx.$0.ElKey,this.treeNode.Holes=P.filter(function(cA){return cA.ElKey!==cy;},this.treeNode.Holes),this.holeUpdates.Set(P.filter(function(cA){return cz(cA[0]);},this.holeUpdates.Get()))):e.FailWith("DocUpdater.RemoveUpdated expects a single element node");},AddUpdated:function(cw){var cx,cy,cz;cx=cw.docNode;cx!=null&&cx.$==1?(cy=cx.$0,this.treeNode.Holes=this.treeNode.Holes.concat([cy]),cz=this.holeUpdates.Get(),cz.push([cy.ElKey,cw.updates]),this.holeUpdates.Set(cz)):e.FailWith("DocUpdater.AddUpdated expects a single element node");}},$,ba);ba.New=cs.Ctor(function(cw,cx,cy,cz,cA){var cB,cC,cD,cE;function cF(cG){return cG[1];}$.New$1.call(this,{$:6,$0:cw},V.Map2Unit(cx,(cB=cA.get_View(),V.BindInner((cC=function(cG){return P.map(cF,cG);},(cD=(cE=V.Const(),function(cG){return bW.TreeReduce(cE,V.Map2Unit,cG);}),function(cG){return cD(cC(cG));})),cB))),cy,cz);this.treeNode=cw;this.holeUpdates=cA;this.origHoles=this.treeNode.Holes;},ba);bc.New=function(cw,cx,cy){return{c:cw,v:cx,f:cy};};be=bd.attr=cs.Class({},r,be);bg.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(cw){var cx,cy;cx=cu.random()*16|0;cy=cw=="x"?cx:cx&3|8;return cy.toString(16);});};bh=_8.List=cs.Class({GetEnumerator:function(){return bn.Get(this);},GetEnumerator0:function(){return bn.Get0(this);}},null,bh);bi=x.FromView=cs.Class({UpdateMaybe:function(cw){var cx;cx=this;V.Get(function(cy){var cz;cz=cw(cy);cz!=null&&cz.$==1?cx.set(cz.$0):void 0;},this.view);},Set:function(cw){this.set(cw);},get_View:function(){return this.view;},Get:function(){return this.current;},Update:function(cw){var cx;V.Get((cx=this.set,function(cy){return cx(cw(cy));}),this.view);}},y,bi);bi.New=cs.Ctor(function(cw,cx){var cy,cz;cy=this;y.New.call(this);this.set=cx;this.id=bt.Int();this.current=(cz=V.TryGet(cw),cz==null?null:cz.$0);this.view=V.Map(function(cA){cy.current=cA;return cA;},cw);},bi);bj.Dynamic=function(cw,cx){return new bB({$:1,$0:new bD.New(cw,cx)});};bj.Static=function(cw){return new bB({$:3,$0:cw});};bj.EmptyAttr=function(){b7.$cctor();return b7.EmptyAttr;};bj.AppendTree=function(cw,cx){var cy;return cw===null?cx:cx===null?cw:(cy=new bB({$:2,$0:cw,$1:cx}),(bj.SetFlags(cy,bj.Flags(cw)|bj.Flags(cx)),cy));};bj.Insert=function(cw,cx){var cy,cz,cA;function cB(cC){if(!(cC===null))if(cC!=null&&cC.$==1)cy.push(cC.$0);else if(cC!=null&&cC.$==2){cB(cC.$0);cB(cC.$1);}else if(cC!=null&&cC.$==3)cC.$0(cw);else if(cC!=null&&cC.$==4)cz.push(cC.$0);}cy=[];cz=[];cB(cx);cA=cy.slice(0);return bT.New(cw,bj.Flags(cx),cA,cz.length===0?null:{$:1,$0:function(cC){_1.iter(function(cD){cD(cC);},cz);}});};bj.HasExitAnim=function(cw){var cx;cx=2;return(cw.DynFlags&cx)===cx;};bj.GetExitAnim=function(cw){return bj.GetAnim(cw,function(cx,cy){return cx.NGetExitAnim(cy);});};bj.HasEnterAnim=function(cw){var cx;cx=1;return(cw.DynFlags&cx)===cx;};bj.GetEnterAnim=function(cw){return bj.GetAnim(cw,function(cx,cy){return cx.NGetEnterAnim(cy);});};bj.HasChangeAnim=function(cw){var cx;cx=4;return(cw.DynFlags&cx)===cx;};bj.GetChangeAnim=function(cw){return bj.GetAnim(cw,function(cx,cy){return cx.NGetChangeAnim(cy);});};bj.Updates=function(cw){return bW.MapTreeReduce(function(cx){return cx.NChanged();},V.Const(),V.Map2Unit,cw.DynNodes);};bj.SetFlags=function(cw,cx){cw.flags=cx;};bj.Flags=function(cw){return cw!==null&&cw.hasOwnProperty("flags")?cw.flags:0;};bj.Empty=function(cw){return bT.New(cw,0,[],null);};bj.GetAnim=function(cw,cx){return bN.Concat(P.map(function(cy){return cx(cy,cw.DynElem);},cw.DynNodes));};bj.Sync=function(cw,cx){P.iter(function(cy){cy.NSync(cw);},cx.DynNodes);};bk.Map=function(cw,cx){var cy,cz;cy=cx.s;return cy!=null&&cy.$==0?bk.New({$:0,$0:cw(cy.$0)}):(cz=bk.New({$:3,$0:[],$1:[]}),(bk.When(cx,function(cA){bk.MarkDone(cz,cx,cw(cA));},cz),cz));};bk.WhenObsoleteRun=function(cw,cx){var cy;cy=cw.s;cy==null?cx():cy!=null&&cy.$==2?cy.$1.push(cx):cy!=null&&cy.$==3?cy.$1.push(cx):void 0;};bk.When=function(cw,cx,cy){var cz;cz=cw.s;cz==null?bk.Obsolete(cy):cz!=null&&cz.$==2?(bk.EnqueueSafe(cz.$1,cy),cx(cz.$0)):cz!=null&&cz.$==3?(cz.$0.push(cx),bk.EnqueueSafe(cz.$1,cy)):cx(cz.$0);};bk.MarkDone=function(cw,cx,cy){var cz;if(cz=cx.s,cz!=null&&cz.$==0)bk.MarkForever(cw,cy);else bk.MarkReady(cw,cy);};bk.WhenRun=function(cw,cx,cy){var cz;cz=cw.s;cz==null?cy():cz!=null&&cz.$==2?(cz.$1.push(cy),cx(cz.$0)):cz!=null&&cz.$==3?(cz.$0.push(cx),cz.$1.push(cy)):cx(cz.$0);};bk.TryGet=function(cw){var cx,cy;cx=cw.s;return(cx!=null&&cx.$==0?(cy=cx.$0,true):cx!=null&&cx.$==2&&(cy=cx.$0,true))?{$:1,$0:cy}:null;};bk.EnqueueSafe=function(cw,cx){var cy,cz,cA,cB;cw.push(cx);if(cw.length%20===0){cy=cw.slice(0);ci.Clear(cw);for(cz=0,cA=P.length(cy)-1;cz<=cA;cz++){cB=P.get(cy,cz);typeof cB=="object"?function(cC){if(cC.s)cw.push(cC);}(cB):function(cC){cw.push(cC);}(cB);}}else void 0;};bk.MarkForever=function(cw,cx){var cy,cz,cA,cB;cy=cw.s;if(cy!=null&&cy.$==3){cw.s={$:0,$0:cx};cz=cy.$0;for(cA=0,cB=P.length(cz)-1;cA<=cB;cA++)(P.get(cz,cA))(cx);}else void 0;};bk.MarkReady=function(cw,cx){var cy,cz,cA,cB;cy=cw.s;if(cy!=null&&cy.$==3){cw.s={$:2,$0:cx,$1:cy.$1};cz=cy.$0;for(cA=0,cB=P.length(cz)-1;cA<=cB;cA++)(P.get(cz,cA))(cx);}else void 0;};bk.Map2Unit=function(cw,cx){var cy,cz,cA;function cB(){var cC,cD,cE;if(!(cC=cA.s,cC!=null&&cC.$==0||cC!=null&&cC.$==2)){cD=bk.ValueAndForever(cw);cE=bk.ValueAndForever(cx);cD!=null&&cD.$==1?cE!=null&&cE.$==1?cD.$0[1]&&cE.$0[1]?bk.MarkForever(cA,null):bk.MarkReady(cA,null):void 0:void 0;}}cy=cw.s;cz=cx.s;return cy!=null&&cy.$==0?cz!=null&&cz.$==0?bk.New({$:0,$0:null}):cx:cz!=null&&cz.$==0?cw:(cA=bk.New({$:3,$0:[],$1:[]}),(bk.When(cw,cB,cA),bk.When(cx,cB,cA),cA));};bk.ValueAndForever=function(cw){var cx;cx=cw.s;return cx!=null&&cx.$==0?{$:1,$0:[cx.$0,true]}:cx!=null&&cx.$==2?{$:1,$0:[cx.$0,false]}:null;};bk.JoinInner=function(cw){var cx;cx=bk.New({$:3,$0:[],$1:[]});bk.When(cw,function(cy){var cz;cz=cy();bk.When(cz,function(cA){var cB,cC;if((cB=cz.s,cB!=null&&cB.$==0)&&(cC=cw.s,cC!=null&&cC.$==0))bk.MarkForever(cx,cA);else bk.MarkReady(cx,cA);},cx);bk.WhenObsolete(cw,cz);},cx);return cx;};bk.Copy=function(cw){var cx,cy,cz;cx=cw.s;return cx==null?cw:cx!=null&&cx.$==2?(cy=bk.New({$:2,$0:cx.$0,$1:[]}),(bk.WhenObsolete(cw,cy),cy)):cx!=null&&cx.$==3?(cz=bk.New({$:3,$0:[],$1:[]}),(bk.When(cw,function(cA){bk.MarkDone(cz,cw,cA);},cz),cz)):cw;};bk.Map3=function(cw,cx,cy,cz){var cA,cB,cC,cD;function cE(cF){var cG,cH,cI,cJ;if(!(cG=cD.s,cG!=null&&cG.$==0||cG!=null&&cG.$==2)){cH=bk.ValueAndForever(cx);cI=bk.ValueAndForever(cy);cJ=bk.ValueAndForever(cz);cH!=null&&cH.$==1?cI!=null&&cI.$==1?cJ!=null&&cJ.$==1?cH.$0[1]&&cI.$0[1]&&cJ.$0[1]?bk.MarkForever(cD,cw(cH.$0[0],cI.$0[0],cJ.$0[0])):bk.MarkReady(cD,cw(cH.$0[0],cI.$0[0],cJ.$0[0])):void 0:void 0:void 0;}}cA=cx.s;cB=cy.s;cC=cz.s;return cA!=null&&cA.$==0?cB!=null&&cB.$==0?cC!=null&&cC.$==0?bk.New({$:0,$0:cw(cA.$0,cB.$0,cC.$0)}):bk.Map3Opt1(cw,cA.$0,cB.$0,cz):cC!=null&&cC.$==0?bk.Map3Opt2(cw,cA.$0,cC.$0,cy):bk.Map3Opt3(cw,cA.$0,cy,cz):cB!=null&&cB.$==0?cC!=null&&cC.$==0?bk.Map3Opt4(cw,cB.$0,cC.$0,cx):bk.Map3Opt5(cw,cB.$0,cx,cz):cC!=null&&cC.$==0?bk.Map3Opt6(cw,cC.$0,cx,cy):(cD=bk.New({$:3,$0:[],$1:[]}),(bk.When(cx,cE,cD),bk.When(cy,cE,cD),bk.When(cz,cE,cD),cD));};bk.Sequence=function(cw){var cx,cy,cz;function cA(cB){var cC;if(cz[0]===0){cC=P.map(function(cD){var cE;cE=cD.s;return cE!=null&&cE.$==0?cE.$0:cE!=null&&cE.$==2?cE.$0:e.FailWith("value not found by View.Sequence");},cx);P.forall(function(cD){var cE;cE=cD.s;return cE!=null&&cE.$==0;},cx)?bk.MarkForever(cy,cC):bk.MarkReady(cy,cC);}else cz[0]--;}cx=P.ofSeq(cw);return cx.length==0?bk.New({$:0,$0:[]}):(cy=bk.New({$:3,$0:[],$1:[]}),(cz=[P.length(cx)-1],(P.iter(function(cB){bk.When(cB,cA,cy);},cx),cy)));};bk.Map2=function(cw,cx,cy){var cz,cA,cB;function cC(cD){var cE,cF,cG;if(!(cE=cB.s,cE!=null&&cE.$==0||cE!=null&&cE.$==2)){cF=bk.ValueAndForever(cx);cG=bk.ValueAndForever(cy);cF!=null&&cF.$==1?cG!=null&&cG.$==1?cF.$0[1]&&cG.$0[1]?bk.MarkForever(cB,cw(cF.$0[0],cG.$0[0])):bk.MarkReady(cB,cw(cF.$0[0],cG.$0[0])):void 0:void 0;}}cz=cx.s;cA=cy.s;return cz!=null&&cz.$==0?cA!=null&&cA.$==0?bk.New({$:0,$0:cw(cz.$0,cA.$0)}):bk.Map2Opt1(cw,cz.$0,cy):cA!=null&&cA.$==0?bk.Map2Opt2(cw,cA.$0,cx):(cB=bk.New({$:3,$0:[],$1:[]}),(bk.When(cx,cC,cB),bk.When(cy,cC,cB),cB));};bk.WhenObsolete=function(cw,cx){var cy;cy=cw.s;cy==null?bk.Obsolete(cx):cy!=null&&cy.$==2?bk.EnqueueSafe(cy.$1,cx):cy!=null&&cy.$==3?bk.EnqueueSafe(cy.$1,cx):void 0;};bk.Map3Opt1=function(cw,cx,cy,cz){return bk.Map(function(cA){return cw(cx,cy,cA);},cz);};bk.Map3Opt2=function(cw,cx,cy,cz){return bk.Map(function(cA){return cw(cx,cA,cy);},cz);};bk.Map3Opt3=function(cw,cx,cy,cz){return bk.Map2(function(cA,cB){return cw(cx,cA,cB);},cy,cz);};bk.Map3Opt4=function(cw,cx,cy,cz){return bk.Map(function(cA){return cw(cA,cx,cy);},cz);};bk.Map3Opt5=function(cw,cx,cy,cz){return bk.Map2(function(cA,cB){return cw(cA,cx,cB);},cy,cz);};bk.Map3Opt6=function(cw,cx,cy,cz){return bk.Map2(function(cA,cB){return cw(cA,cB,cx);},cy,cz);};bk.Map2Opt1=function(cw,cx,cy){return bk.Map(function(cz){return cw(cx,cz);},cy);};bk.Map2Opt2=function(cw,cx,cy){return bk.Map(function(cz){return cw(cz,cx);},cy);};bk.Join=function(cw){var cx;cx=bk.New({$:3,$0:[],$1:[]});bk.When(cw,function(cy){var cz;cz=cy();bk.When(cz,function(cA){var cB,cC;if((cB=cz.s,cB!=null&&cB.$==0)&&(cC=cw.s,cC!=null&&cC.$==0))bk.MarkForever(cx,cA);else bk.MarkReady(cx,cA);},cx);},cx);return cx;};bm.JSUnion=function(cw,cx){var cy;function cz(cD){var cE;function cF(cG){return cG!=null&&cG.$==1&&I.Equals(cD,cG.$0);}cE=_1.tryFindIndex(function(cG){return cF(cG[0]);},cx);return cE!=null&&cE.$==1?cE.$0:cD.$;}function cA(cD,cE){return P.init(P.length((P.get(cx,cD))[2]),function(cF){return cE["$"+a.String(cF)];});}function cB(cD,cE){var cF,cG,cH;cF=cw==null?{}:new cw();cG=P.get(cx,cD);return(cH=cG[0],cH!=null&&cH.$==1)?cG[0].$0:(cF.$=cD,_1.iteri(function(cI,cJ){cF["$"+a.String(cI)]=cJ;},cE),cF);}function cC(cD,cE){var cF;function cG(cH,cI){return[cD,cH,cI,cF];}cF=cE[2];return _1.map(function(cH){return cG(cH[0],cH[1]);},cE[1]);}cy=_1.collect(function(cD){return cC(cD[0],cD[1]);},_1.indexed(cx));return bF.New$1(function(cD){function cE(cF,cG,cH,cI){var cJ,cK,cL;function cM(cN,cO,cP){var cQ;function cR(cS,cT){return cM(cQ,cS,new v({$:1,$0:cT,$1:cP}));}return cN.$==1?(cQ=cN.$1,_1.collect(function(cS){return cR(cS[0],cS[1]);},cN.$0.Parse(cO))):[[cO,cB(cF,P.ofList(u.rev(cP)))]];}return bm.isCorrectMethod(cG,cD.Method)?(cJ=bG.startsWith(u.ofArray(cH),cD.Segments),cJ==null?[]:(cK=cJ.$0,(cL=u.ofArray(cI),cL.$==0?[[br.New(cK,cD.QueryArgs,cD.FormData,cD.Method,cD.Body),cB(cF,[])]]:cM(cL,br.New(cK,cD.QueryArgs,cD.FormData,cD.Method,cD.Body),v.Empty)))):[];}return _1.collect(function(cF){return cE(cF[0],cF[1],cF[2],cF[3]);},cy);},function(cD){var cE,cF,cG,cH,cI,cJ;function cK(cL,cM){return cM.Write(cL);}cE=cz(cD);cF=P.get(cx,cE);cG=cF[2];cH=P.get(cF[1],0);cI=[br.Segment(u.ofArray(cH[1]),cH[0])];return!I.Equals(cG,null)&&cG.length===0?{$:1,$0:cI}:(cJ=(((cs.Curried3(P.map2))(cK))(cA(cE,cD)))(cG),P.forall(function(cL){return cL!=null;},cJ)?{$:1,$0:_1.append(cI,_1.collect(function(cL){return cL.$0;},cJ))}:null);});};bm.isCorrectMethod=function(cw,cx){return cx!=null&&cx.$==1?cw!=null&&cw.$==1?I.Equals(cx.$0,cw.$0):true:!(cw!=null&&cw.$==1);};bn.Get=function(cw){return cw instanceof a.Array?bn.ArrayEnumerator(cw):I.Equals(typeof cw,"string")?bn.StringEnumerator(cw):cw.GetEnumerator();};bn.ArrayEnumerator=function(cw){return new bo.New(0,null,function(cx){var cy;cy=cx.s;return cy<P.length(cw)&&(cx.c=P.get(cw,cy),cx.s=cy+1,true);},void 0);};bn.StringEnumerator=function(cw){return new bo.New(0,null,function(cx){var cy;cy=cx.s;return cy<cw.length&&(cx.c=cw[cy],cx.s=cy+1,true);},void 0);};bn.Get0=function(cw){return cw instanceof a.Array?bn.ArrayEnumerator(cw):I.Equals(typeof cw,"string")?bn.StringEnumerator(cw):"GetEnumerator0"in cw?cw.GetEnumerator0():cw.GetEnumerator();};bo=bn.T=cs.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},r,bo);bo.New=cs.Ctor(function(cw,cx,cy,cz){r.New.call(this);this.s=cw;this.c=cx;this.n=cy;this.d=cz;},bo);bp.prettyPrint=function(cw){var cx,cy;function cz(cA,cB){return cA+" = "+bp.prettyPrint(cB);}return cw===null?"null":(cx=typeof cw,cx=="string"?"\""+cw+"\"":cx=="object"?cw instanceof a.Array?"[|"+X.concat("; ",P.map(bp.prettyPrint,cw))+"|]":(cy=a.String(cw),cy==="[object Object]"?"{"+X.concat("; ",P.map(function(cA){return cz(cA[0],cA[1]);},_5.GetFields(cw)))+"}":cy):a.String(cw));};bp.toSafe=function(cw){return cw==null?"":cw;};bq.Parse=function(cw,cx){function cy(cz,cA){return cz.Segments.$==0?{$:1,$0:cA}:null;}return _1.tryPick(function(cz){return cy(cz[0],cz[1]);},cw.Parse(cx));};bq.HashLink=function(cw,cx){return"#"+bq.Link(cw,cx);};bq.Link=function(cw,cx){var cy;cy=bq.Write(cw,cx);return cy==null?"":cy.$0.ToLink();};bq.Write=function(cw,cx){var cy;cy=cw.Write(cx);return cy==null?null:{$:1,$0:br.Combine(cy.$0)};};br=bl.Route=cs.Class({ToLink:function(){return b$.WriteLink(this.Segments,this.QueryArgs);}},null,br);br.FromHash=function(cw,cx){var cy,cz;cy=cw.indexOf("#");return cy===-1?br.get_Empty():(cz=cw.substring(cy+1),cx!=null&&cx.$0?cz===""||cz==="/"?br.get_Empty():X.StartsWith(cz,"/")?br.FromUrl(cz.substring(1),{$:1,$0:true}):br.Segment$2(cz):br.FromUrl(cw.substring(cy),{$:1,$0:false}));};br.Segment=function(cw,cx){var cy;cy=br.get_Empty();return br.New(cw,cy.QueryArgs,cy.FormData,cx,cy.Body);};br.get_Empty=function(){return br.New(v.Empty,new bX.New([]),new bX.New([]),null,J.CreateFromValue(null));};br.FromUrl=function(cw,cx){var cy,cz,cA;cy=(cz=cw.indexOf("?"),cz===-1?[cw,new bX.New([])]:[X.Substring(cw,0,cz),br.ParseQuery(cw.substring(cz+1))]);cA=br.get_Empty();return br.New(u.ofArray(X.SplitChars(cy[0],["/"],cx!=null&&cx.$0?0:1)),cy[1],cA.FormData,cA.Method,cA.Body);};br.Segment$2=function(cw){var cx;cx=br.get_Empty();return br.New(u.ofArray([cw]),cx.QueryArgs,cx.FormData,cx.Method,cx.Body);};br.ParseQuery=function(cw){return bY.OfArray(P.ofSeq(P.choose(function(cx){var cy,cz;cy=X.SplitChars(cx,["="],0);return!I.Equals(cy,null)&&cy.length===2?(cz=P.get(cy,1),{$:1,$0:[P.get(cy,0),cz]}):((function(cA){return function(cB){return cA("wrong format for query argument: "+bp.toSafe(cB));};}(function(cA){cq.log(cA);}))(cx),null);},X.SplitChars(cw,["&"],0))));};br.Combine=function(cw){var cx,cy,cz,cA,cB,cC,cD;cx=P.ofSeq(cw);cy=P.length(cx);return cy===0?br.get_Empty():cy===1?P.get(cx,0):(cz=null,cA=null,cB=[],cC=new bX.New([]),cD=new bX.New([]),P.iter(function(cE){var cF,cG;cF=cE.Method;cF!=null&&cF.$==1?cz=cF:void 0;cG=cE.Body.f();cG===null?void 0:cA=cG;cC=bY.FoldBack(function(cH,cI,cJ){return cJ.Add(cH,cI);},cC,cE.QueryArgs);cD=bY.FoldBack(function(cH,cI,cJ){return cJ.Add(cH,cI);},cD,cE.FormData);u.iter(function(cH){cB.push(cH);},cE.Segments);},cx),br.New(u.ofSeq(cB),cC,cD,cz,J.CreateFromValue(cA)));};br.New=function(cw,cx,cy,cz,cA){return new br({Segments:cw,QueryArgs:cx,FormData:cy,Method:cz,Body:cA});};bt.Id=function(){bt.set_counter(bt.counter()+1);return"uid"+a.String(bt.counter());};bt.Int=function(){bt.set_counter(bt.counter()+1);return bt.counter();};bt.set_counter=function(cw){bZ.$cctor();bZ.counter=cw;};bt.counter=function(){bZ.$cctor();return bZ.counter;};bu.$cctor=function(){bu.$cctor=a.ignore;bu.LoadedTemplates=new _9.New$5();bu.LocalTemplatesLoaded=false;bu.GlobalHoles=new _9.New$5();bu.TextHoleRE="\\${([^}]+)}";bu.RenderedFullDocTemplate=null;};bv=_8.HashSet=cs.Class({Add:function(cw){return this.add(cw);},Contains:function(cw){var cx;cx=this.data[this.hash(cw)];return cx==null?false:this.arrContains(cw,cx);},add:function(cw){var cx,cy;cx=this.hash(cw);cy=this.data[cx];return cy==null?(this.data[cx]=[cw],this.count=this.count+1,true):this.arrContains(cw,cy)?false:(cy.push(cw),this.count=this.count+1,true);},arrContains:function(cw,cx){var cy,cz,cA,cB;cy=true;cz=0;cB=cx.length;while(cy&&cz<cB)if(this.equals.apply(null,[cx[cz],cw]))cy=false;else cz=cz+1;return!cy;},ExceptWith:function(cw){var cx;cx=bn.Get(cw);try{while(cx.MoveNext())this.Remove(cx.Current());}finally{if(typeof cx=="object"&&"Dispose"in cx)cx.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(cw){var cx,cy,cz,cA;cx=0;cy=cd.concat(this.data);for(cz=0,cA=cy.length-1;cz<=cA;cz++)P.set(cw,cz,cy[cz]);},IntersectWith:function(cw){var cx,cy,cz,cA,cB;cx=new bv.New$4(cw,this.equals,this.hash);cy=cd.concat(this.data);for(cz=0,cA=cy.length-1;cz<=cA;cz++){cB=cy[cz];!cx.Contains(cB)?this.Remove(cB):void 0;}},Remove:function(cw){var cx;cx=this.data[this.hash(cw)];return cx==null?false:this.arrRemove(cw,cx)&&(this.count=this.count-1,true);},arrRemove:function(cw,cx){var cy,cz,cA,cB;cy=true;cz=0;cB=cx.length;while(cy&&cz<cB)if(this.equals.apply(null,[cx[cz],cw])){cx.splice.apply(cx,[cz,1]);cy=false;}else cz=cz+1;return!cy;},GetEnumerator:function(){return bn.Get(cd.concat(this.data));},GetEnumerator0:function(){return bn.Get(cd.concat(this.data));}},r,bv);bv.New$3=cs.Ctor(function(){bv.New$4.call(this,[],I.Equals,I.Hash);},bv);bv.New$4=cs.Ctor(function(cw,cx,cy){var cz;r.New.call(this);this.equals=cx;this.hash=cy;this.data=[];this.count=0;cz=bn.Get(cw);try{while(cz.MoveNext())this.add(cz.Current());}finally{if(typeof cz=="object"&&"Dispose"in cz)cz.Dispose();}},bv);bv.New$2=cs.Ctor(function(cw){bv.New$4.call(this,cw,I.Equals,I.Hash);},bv);bw.LinkElement=function(cw,cx){bw.InsertDoc(cw,cx,null);};bw.InsertDoc=function(cw,cx,cy){var cz;return cx!=null&&cx.$==1?bw.InsertNode(cw,cx.$0.El,cy):cx!=null&&cx.$==2?(cz=cx.$0,(cz.Dirty=false,bw.InsertDoc(cw,cz.Current,cy))):cx==null?cy:cx!=null&&cx.$==4?bw.InsertNode(cw,cx.$0.Text,cy):cx!=null&&cx.$==5?bw.InsertNode(cw,cx.$0,cy):cx!=null&&cx.$==6?P.foldBack(function(cA,cB){return cA==null||cA.constructor===_6?bw.InsertDoc(cw,cA,cB):bw.InsertNode(cw,cA,cB);},cx.$0.Els,cy):bw.InsertDoc(cw,cx.$0,bw.InsertDoc(cw,cx.$1,cy));};bw.CreateRunState=function(cw,cx){return b1.New(b2.get_Empty(),bw.CreateElemNode(cw,bj.EmptyAttr(),cx));};bw.PerformAnimatedUpdate=function(cw,cx,cy){var cz;return bN.get_UseAnimations()?(cz=null,by.Delay(function(){var cA,cB,cC;cA=b2.FindAll(cy);cB=bw.ComputeChangeAnim(cx,cA);cC=bw.ComputeEnterAnim(cx,cA);return by.Bind(bN.Play(bN.Append(cB,bw.ComputeExitAnim(cx,cA))),function(){return by.Bind(bw.SyncElemNodesNextFrame(cw,cx),function(){return by.Bind(bN.Play(cC),function(){cx.PreviousNodes=cA;return by.Return(null);});});});})):bw.SyncElemNodesNextFrame(cw,cx);};bw.PerformSyncUpdate=function(cw,cx,cy){var cz;cz=b2.FindAll(cy);bw.SyncElemNode(cw,cx.Top);cx.PreviousNodes=cz;};bw.InsertNode=function(cw,cx,cy){bK.InsertAt(cw,cy,cx);return cx;};bw.CreateElemNode=function(cw,cx,cy){var cz;bw.LinkElement(cw,cy);cz=bj.Insert(cw,cx);return bA.New(cz,cy,null,cw,bt.Int(),cs.GetOptional(cz.OnAfterRender));};bw.SyncElemNodesNextFrame=function(cw,cx){function cy(cz){a.requestAnimationFrame(function(){bw.SyncElemNode(cw,cx.Top);cz();});}return bO.BatchUpdatesEnabled()?by.FromContinuations(function(cz,cA,cB){return cy.apply(null,[cz,cA,cB]);}):(bw.SyncElemNode(cw,cx.Top),by.Return(null));};bw.ComputeExitAnim=function(cw,cx){return bN.Concat(P.map(function(cy){return bj.GetExitAnim(cy.Attr);},b2.ToArray(b2.Except(cx,b2.Filter(function(cy){return bj.HasExitAnim(cy.Attr);},cw.PreviousNodes)))));};bw.ComputeEnterAnim=function(cw,cx){return bN.Concat(P.map(function(cy){return bj.GetEnterAnim(cy.Attr);},b2.ToArray(b2.Except(cw.PreviousNodes,b2.Filter(function(cy){return bj.HasEnterAnim(cy.Attr);},cx)))));};bw.ComputeChangeAnim=function(cw,cx){var cy;function cz(cA){return bj.HasChangeAnim(cA.Attr);}cy=function(cA){return b2.Filter(cz,cA);};return bN.Concat(P.map(function(cA){return bj.GetChangeAnim(cA.Attr);},b2.ToArray(b2.Intersect(cy(cw.PreviousNodes),cy(cx)))));};bw.SyncElemNode=function(cw,cx){!cw?bw.SyncElement(cx):void 0;bw.Sync(cx.Children);bw.AfterRender(cx);};bw.SyncElement=function(cw){function cx(cy){function cz(cA){var cB,cC;return cA!=null&&cA.$==0?cz(cA.$0)||cz(cA.$1):cA!=null&&cA.$==2?(cB=cA.$0,cB.Dirty||cz(cB.Current)):cA!=null&&cA.$==6&&(cC=cA.$0,cC.Dirty||P.exists(cx,cC.Holes));}return cz(cy.Children);}bj.Sync(cw.El,cw.Attr);cx(cw)?bw.DoSyncElement(cw):void 0;};bw.Sync=function(cw){var cx,cy;if(cw!=null&&cw.$==1)bw.SyncElemNode(false,cw.$0);else if(cw!=null&&cw.$==2)bw.Sync(cw.$0.Current);else if(cw==null);else if(cw!=null&&cw.$==5);else if(cw!=null&&cw.$==4){cx=cw.$0;cx.Dirty?(cx.Text.nodeValue=cx.Value,cx.Dirty=false):void 0;}else if(cw!=null&&cw.$==6){cy=cw.$0;P.iter(function(cz){bw.SyncElemNode(false,cz);},cy.Holes);P.iter(function(cz){bj.Sync(cz[0],cz[1]);},cy.Attrs);bw.AfterRender(cy);}else{bw.Sync(cw.$0);bw.Sync(cw.$1);}};bw.AfterRender=function(cw){var cx;cx=cs.GetOptional(cw.Render);cx!=null&&cx.$==1?(cx.$0(cw.El),cs.SetOptional(cw,"Render",null)):void 0;};bw.InsertBeforeDelim=function(cw,cx){var cy,cz;cy=cw.parentNode;cz=self.document.createTextNode("");cy.insertBefore(cz,cw);bw.LinkPrevElement(cw,cx);return cz;};bw.CreateEmbedNode=function(){return{Current:null,Dirty:false};};bw.UpdateEmbedNode=function(cw,cx){cw.Current=cx;cw.Dirty=true;};bw.DoSyncElement=function(cw){var cx,cy,cz;function cA(cB,cC){var cD,cE;return cB!=null&&cB.$==1?cB.$0.El:cB!=null&&cB.$==2?(cD=cB.$0,cD.Dirty?(cD.Dirty=false,bw.InsertDoc(cx,cD.Current,cC)):cA(cD.Current,cC)):cB==null?cC:cB!=null&&cB.$==4?cB.$0.Text:cB!=null&&cB.$==5?cB.$0:cB!=null&&cB.$==6?(cE=cB.$0,(cE.Dirty?cE.Dirty=false:void 0,P.foldBack(function(cF,cG){return cF==null||cF.constructor===_6?cA(cF,cG):cF;},cE.Els,cC))):cA(cB.$0,cA(cB.$1,cC));}cx=cw.El;cn.Iter((cy=cw.El,function(cB){bK.RemoveNode(cy,cB);}),cn.Except(cn.DocChildren(cw),cn.Children(cw.El,cs.GetOptional(cw.Delimiters))));cA(cw.Children,(cz=cs.GetOptional(cw.Delimiters),cz!=null&&cz.$==1?cz.$0[1]:null));};bw.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};bw.UpdateTextNode=function(cw,cx){cw.Value=cx;cw.Dirty=true;};bw.LinkPrevElement=function(cw,cx){bw.InsertDoc(cw.parentNode,cx,cw);};bx=x.ConcreteVar=cs.Class({UpdateMaybe:function(cw){var cx;cx=cw(this.Get());cx!=null&&cx.$==1?this.Set(cx.$0):void 0;},Set:function(cw){if(this.isConst)(function(cx){return cx("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cx){cq.log(cx);}));else{bk.Obsolete(this.snap);this.current=cw;this.snap=bk.New({$:2,$0:cw,$1:[]});}},get_View:function(){return this.view;},Get:function(){return this.current;},Update:function(cw){this.Set(cw(this.Get()));}},y,bx);bx.New=cs.Ctor(function(cw,cx,cy){var cz;cz=this;y.New.call(this);this.isConst=cw;this.current=cy;this.snap=cx;this.view=function(){return cz.snap;};this.id=bt.Int();},bx);by.Start=function(cw,cx){var cy,cz;cy=(cz=(by.defCTS())[0],cx==null?cz:cx.$0);by.scheduler().Fork(function(){if(!cy.c)cw(bR.New(function(cA){if(cA.$==1)by.UncaughtAsyncError(cA.$0);},cy));});};by.defCTS=function(){b5.$cctor();return b5.defCTS;};by.UncaughtAsyncError=function(cw){cq.log("WebSharper: Uncaught asynchronous exception",cw);};by.scheduler=function(){b5.$cctor();return b5.scheduler;};by.Delay=function(cw){return function(cx){try{(cw(null))(cx);}catch(cy){cx.k({$:1,$0:cy});}};};by.Bind=function(cw,cx){return by.checkCancel(function(cy){cw(bR.New(function(cz){var cA;if(cz.$==0){cA=cz.$0;by.scheduler().Fork(function(){try{(cx(cA))(cy);}catch(cB){cy.k({$:1,$0:cB});}});}else by.scheduler().Fork(function(){cy.k(cz);});},cy.ct));});};by.Zero=function(){b5.$cctor();return b5.Zero;};by.Return=function(cw){return function(cx){cx.k({$:0,$0:cw});};};by.checkCancel=function(cw){return function(cx){if(cx.ct.c)by.cancel(cx);else cw(cx);};};by.FromContinuations=function(cw){return function(cx){var cy;function cz(cA){if(cy[0])e.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{cy[0]=true;by.scheduler().Fork(cA);}}cy=[false];cw(function(cA){cz(function(){cx.k({$:0,$0:cA});});},function(cA){cz(function(){cx.k({$:1,$0:cA});});},function(cA){cz(function(){cx.k({$:2,$0:cA});});});};};by.cancel=function(cw){cw.k({$:2,$0:new co.New(cw.ct)});};bz=x.Updates=cs.Class({},null,bz);bz.Create=function(cw){var cx;cx=null;cx=bz.New(cw,null,function(){var cy;cy=cx.s;return cy===null?(cy=bk.Copy(cx.c()),cx.s=cy,bk.WhenObsoleteRun(cy,function(){cx.s=null;}),cy):cy;});return cx;};bz.New=function(cw,cx,cy){return new bz({c:cw,s:cx,v:cy});};bA=x.DocElemNode=cs.Class({Equals:function(cw){return this.ElKey===cw.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bA);bA.New=function(cw,cx,cy,cz,cA,cB){var cC;return new bA((cC={Attr:cw,Children:cx,El:cz,ElKey:cA},(cs.SetOptional(cC,"Delimiters",cy),cs.SetOptional(cC,"Render",cB),cC)));};bB=x.AttrProxy=cs.Class({},null,bB);bB.Create=function(cw,cx){return bj.Static(function(cy){cy.setAttribute(cw,cx);});};bB.Concat=function(cw){var cx;cx=bW.ofSeqNonCopying(cw);return bW.TreeReduce(bj.EmptyAttr(),bB.Append,cx);};bB.Append=function(cw,cx){return bj.AppendTree(cw,cx);};bB.Handler=function(cw,cx){return bB.HandlerImpl(cw,cx);};bB.HandlerImpl=function(cw,cx){return bj.Static(function(cy){cy.addEventListener(cw,function(cz){return(cx(cy))(cz);},false);});};bC.$cctor=function(){bC.$cctor=a.ignore;bC.initialized=new _9.New$5();};bC=N.TemplateInitializer=cs.Class({},r,bC);bC.GetOrAddHoleFor=function(cw,cx,cy){var cz,cA,cB,cC;bC.$cctor();cz=bC.GetHolesFor(cw);cA=(cB=null,[cz.TryGetValue(cx,{get:function(){return cB;},set:function(cD){cB=cD;}}),cB]);return cA[0]?cA[1]:(cC=cy(),(cz.set_Item(cx,cC),cC));};bC.GetHolesFor=function(cw){var cx,cy,cz;bC.$cctor();cx=(cy=null,[bC.initialized.TryGetValue(cw,{get:function(){return cy;},set:function(cA){cy=cA;}}),cy]);return cx[0]?cx[1]:(cz=new _9.New$5(),(bC.initialized.set_Item(cw,cz),cz));};bD=x.DynamicAttrNode=cs.Class({NGetExitAnim:function(cw){return bN.get_Empty();},NGetEnterAnim:function(cw){return bN.get_Empty();},NGetChangeAnim:function(cw){return bN.get_Empty();},NChanged:function(){return this.updates;},NSync:function(cw){if(this.dirty){(this.push(cw))(this.value);this.dirty=false;}}},r,bD);bD.New=cs.Ctor(function(cw,cx){var cy;cy=this;r.New.call(this);this.push=cx;this.value=void 0;this.dirty=false;this.updates=V.Map(function(cz){cy.value=cz;cy.dirty=true;},cw);},bD);bk.Obsolete=function(cw){var cx,cy,cz,cA,cB;cy=cw.s;if(cy==null||(cy!=null&&cy.$==2?(cx=cy.$1,false):cy!=null&&cy.$==3?(cx=cy.$1,false):true))void 0;else{cw.s=null;for(cz=0,cA=P.length(cx)-1;cz<=cA;cz++){cB=P.get(cx,cz);typeof cB=="object"?function(cC){bk.Obsolete(cC);}(cB):cB();}}};bk.New=function(cw){return{s:cw};};bE=x.CheckedInput=cs.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bE);P.mapiInPlace=function(cw,cx){var cy,cz;for(cy=0,cz=cx.length-1;cy<=cz;cy++)cx[cy]=cw(cy,cx[cy]);return cx;};P.mapInPlace=function(cw,cx){var cy,cz;for(cy=0,cz=cx.length-1;cy<=cz;cy++)cx[cy]=cw(cx[cy]);};_1.insufficient=function(){return e.FailWith("The input sequence has an insufficient number of elements.");};bF.New$1=function(cw,cx){return{Parse:cw,Write:cx};};bG.startsWith=function(cw,cx){var cy;switch(cw.$==1?cx.$==1?I.Equals(cw.$0,cx.$0)?(cy=[cx.$0,cx.$1,cw.$0,cw.$1],1):2:2:0){case 0:return{$:1,$0:cx};case 1:return bG.startsWith(cy[3],cy[1]);case 2:return null;}};bH.notPresent=function(){return e.FailWith("The given key was not present in the dictionary.");};bI.convertTextNode=function(cw){var cx,cy,cz,cA,cB,cC;cx=null;cy=0;cA=cw.textContent;cB=new a.RegExp(D.TextHoleRE(),"g");while(cx=cB.exec(cA),cx!==null){cw.parentNode.insertBefore(self.document.createTextNode(bJ.string(cA,{$:1,$0:cy},{$:1,$0:cB.lastIndex-P.get(cx,0).length-1})),cw);cy=cB.lastIndex;cC=self.document.createElement("span");cC.setAttribute("ws-replace",P.get(cx,1).toLowerCase());cw.parentNode.insertBefore(cC,cw);}cB.lastIndex=0;cw.textContent=bJ.string(cA,{$:1,$0:cy},null);};bI.failNotLoaded=function(cw){cq.warn("Instantiating non-loaded template",cw);};bI.fillTextHole=function(cw,cx,cy){var cz;cz=cw.querySelector("[ws-replace]");return I.Equals(cz,null)?(cq.warn("Filling non-existent text hole",cy),null):(cz.parentNode.replaceChild(new a.Text(cx),cz),{$:1,$0:cz.getAttribute("ws-replace")});};bI.removeHolesExcept=function(cw,cx){function cy(cz){bK.IterSelector(cw,"["+cz+"]",function(cA){if(!cx.Contains(cA.getAttribute(cz)))cA.removeAttribute(cz);});}cy("ws-attr");cy("ws-onafterrender");cy("ws-var");bK.IterSelector(cw,"[ws-hole]",function(cz){if(!cx.Contains(cz.getAttribute("ws-hole"))){cz.removeAttribute("ws-hole");while(cz.hasChildNodes())cz.removeChild(cz.lastChild);}});bK.IterSelector(cw,"[ws-replace]",function(cz){if(!cx.Contains(cz.getAttribute("ws-replace")))cz.parentNode.removeChild(cz);});bK.IterSelector(cw,"[ws-on]",function(cz){cz.setAttribute("ws-on",X.concat(" ",P.filter(function(cA){return cx.Contains(P.get(X.SplitChars(cA,[":"],1),1));},X.SplitChars(cz.getAttribute("ws-on"),[" "],1))));});bK.IterSelector(cw,"[ws-attr-holes]",function(cz){var cA,cB,cC,cD,cE;cA=X.SplitChars(cz.getAttribute("ws-attr-holes"),[" "],1);for(cB=0,cC=cA.length-1;cB<=cC;cB++){cD=P.get(cA,cB);cz.setAttribute(cD,(cE=new a.RegExp(D.TextHoleRE(),"g"),cz.getAttribute(cD).replace(cE,function(cF,cG){return cx.Contains(cG)?cF:"";})));}});};bI.fillInstanceAttrs=function(cw,cx){var cy,cz,cA,cB,cC;bI.convertAttrs(cx);cy=cx.nodeName.toLowerCase();cz=cw.querySelector("[ws-attr="+cy+"]");if(I.Equals(cz,null))cq.warn("Filling non-existent attr hole",cy);else{cz.removeAttribute("ws-attr");for(cA=0,cB=cx.attributes.length-1;cA<=cB;cA++){cC=cx.attributes.item(cA);cC.name==="class"&&cz.hasAttribute("class")?cz.setAttribute("class",cz.getAttribute("class")+" "+cC.nodeValue):cz.setAttribute(cC.name,cC.nodeValue);}}};bI.mapHoles=function(cw,cx){function cy(cz){bK.IterSelector(cw,"["+cz+"]",function(cA){var cB,cC;cB=(cC=null,[cx.TryGetValue(cA.getAttribute(cz).toLowerCase(),{get:function(){return cC;},set:function(cD){cC=cD;}}),cC]);cB[0]?cA.setAttribute(cz,cB[1]):void 0;});}cy("ws-hole");cy("ws-replace");cy("ws-attr");cy("ws-onafterrender");cy("ws-var");bK.IterSelector(cw,"[ws-on]",function(cz){cz.setAttribute("ws-on",X.concat(" ",P.map(function(cA){var cB,cC,cD;cB=X.SplitChars(cA,[":"],1);cC=(cD=null,[cx.TryGetValue(P.get(cB,1),{get:function(){return cD;},set:function(cE){cD=cE;}}),cD]);return cC[0]?P.get(cB,0)+":"+cC[1]:cA;},X.SplitChars(cz.getAttribute("ws-on"),[" "],1))));});bK.IterSelector(cw,"[ws-attr-holes]",function(cz){var cA,cB,cC;cA=X.SplitChars(cz.getAttribute("ws-attr-holes"),[" "],1);for(cB=0,cC=cA.length-1;cB<=cC;cB++)(function(){var cD;function cE(cF,cG){var cH;cH=e.KeyValue(cG);return cF.replace(new a.RegExp("\\${"+cH[0]+"}","ig"),"${"+cH[1]+"}");}cD=P.get(cA,cB);return cz.setAttribute(cD,(((cs.Curried3(_1.fold))(cE))(cz.getAttribute(cD)))(cx));}());});};bI.fill=function(cw,cx,cy){while(true)if(cw.hasChildNodes())cy=cx.insertBefore(cw.lastChild,cy);else return null;};bI.convertAttrs=function(cw){var cy,cz,cA,cB,cC,cD,cE,cF;function cx(cG){var cH;cH=cw.getAttribute(cG);cH===null?void 0:cw.setAttribute(cG,cH.toLowerCase());}cy=cw.attributes;cz=[];cA=[];cB=[];for(cC=0,cD=cy.length-1;cC<=cD;cC++){cE=cy.item(cC);X.StartsWith(cE.nodeName,"ws-on")&&cE.nodeName!=="ws-onafterrender"&&cE.nodeName!=="ws-on"?(cz.push(cE.nodeName),cA.push(bJ.string(cE.nodeName,{$:1,$0:"ws-on".length},null)+":"+cE.nodeValue.toLowerCase())):!X.StartsWith(cE.nodeName,"ws-")&&(new a.RegExp(D.TextHoleRE())).test(cE.nodeValue)?(cE.nodeValue=(cF=new a.RegExp(D.TextHoleRE(),"g"),cE.nodeValue.replace(cF,function(cG,cH){return"${"+cH.toLowerCase()+"}";})),cB.push(cE.nodeName)):void 0;}!(cA.length==0)?cw.setAttribute("ws-on",X.concat(" ",cA)):void 0;!(cB.length==0)?cw.setAttribute("ws-attr-holes",X.concat(" ",cB)):void 0;cx("ws-hole");cx("ws-replace");cx("ws-attr");cx("ws-onafterrender");cx("ws-var");P.iter(function(cG){cw.removeAttribute(cG);},cz);};bJ.string=function(cw,cx,cy){return cx==null?cy!=null&&cy.$==1?cw.slice(0,cy.$0+1):"":cy==null?cw.slice(cx.$0):cw.slice(cx.$0,cy.$0+1);};bK.ParseHTMLIntoFakeRoot=function(cw){var cx,cy,cz,cA,cB;cx=self.document.createElement("div");return!bK.rhtml().test(cw)?(cx.appendChild(self.document.createTextNode(cw)),cx):(cy=(cz=bK.rtagName().exec(cw),I.Equals(cz,null)?"":P.get(cz,1).toLowerCase()),(cA=(cB=(bK.wrapMap())[cy],cB?cB:bK.defaultWrap()),(cx.innerHTML=cA[1]+cw.replace(bK.rxhtmlTag(),"<$1></$2>")+cA[2],function(cC,cD){var cE;while(true)if(cD===0)return cC;else{cE=cD;cC=cC.lastChild;cD=cE-1;}}(cx,cA[0]))));};bK.IterSelector=function(cw,cx,cy){var cz,cA,cB;cz=cw.querySelectorAll(cx);for(cA=0,cB=cz.length-1;cA<=cB;cA++)cy(cz[cA]);};bK.rhtml=function(){ca.$cctor();return ca.rhtml;};bK.wrapMap=function(){ca.$cctor();return ca.wrapMap;};bK.defaultWrap=function(){ca.$cctor();return ca.defaultWrap;};bK.rxhtmlTag=function(){ca.$cctor();return ca.rxhtmlTag;};bK.rtagName=function(){ca.$cctor();return ca.rtagName;};bK.InsertAt=function(cw,cx,cy){var cz;if(!(cy.parentNode===cw&&cx===(cz=cy.nextSibling,I.Equals(cz,null)?null:cz)))cw.insertBefore(cy,cx);};bK.ChildrenArray=function(cw){var cx,cy,cz;cx=[];for(cy=0,cz=cw.childNodes.length-1;cy<=cz;cy++)cx.push(cw.childNodes[cy]);return cx;};bK.RemoveNode=function(cw,cx){if(cx.parentNode===cw)cw.removeChild(cx);};bL=_8.KeyCollection=cs.Class({GetEnumerator$1:function(){return bn.Get(_1.map(function(cw){return cw.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},r,bL);bL.New=cs.Ctor(function(cw){r.New.call(this);this.d=cw;},bL);bN.get_UseAnimations=function(){return b3.UseAnimations();};bN.Play=function(cw){var cx;cx=null;return by.Delay(function(){return by.Bind(bN.Run(a.ignore,b3.Actions(cw)),function(){b3.Finalize(cw);return by.Return(null);});});};bN.Append=function(cw,cx){return{$:0,$0:cc.Append(cw.$0,cx.$0)};};bN.Run=function(cw,cx){var cy;function cz(cA){function cB(cC,cD){var cE;cE=cD-cC;cx.Compute(cE);cw();return cE<=cy?void a.requestAnimationFrame(function(cF){cB(cC,cF);}):cA();}a.requestAnimationFrame(function(cC){cB(cC,cC);});}cy=cx.Duration;return cy===0?by.Zero():by.FromContinuations(function(cA,cB,cC){return cz.apply(null,[cA,cB,cC]);});};bN.Concat=function(cw){return{$:0,$0:cc.Concat(_1.map(b3.List,cw))};};bN.get_Empty=function(){return{$:0,$0:cc.Empty()};};bO.BatchUpdatesEnabled=function(){b4.$cctor();return b4.BatchUpdatesEnabled;};bP.StartProcessor=function(cw){var cx;function cy(){var cz;cz=null;return by.Delay(function(){return by.Bind(cw,function(){var cA;cA=cx[0];return cA===1?(cx[0]=0,by.Zero()):cA===2?(cx[0]=1,cy()):by.Zero();});});}cx=[0];return function(){var cz;cz=cx[0];cz===0?(cx[0]=1,by.Start(cy(),null)):cz===1?cx[0]=2:void 0;};};bQ.New=function(cw,cx){return{c:cw,r:cx};};bR.New=function(cw,cx){return{k:cw,ct:cx};};bT.New=function(cw,cx,cy,cz){var cA;cA={DynElem:cw,DynFlags:cx,DynNodes:cy};cs.SetOptional(cA,"OnAfterRender",cz);return cA;};bV=d.InvalidOperationException=cs.Class({},bU,bV);bV.New=cs.Ctor(function(cw){bV.New$2.call(this,cw,null);},bV);bV.New$2=cs.Ctor(function(cw,cx){this.message=cw;this.inner=cx;_6.setPrototypeOf(this,bV.prototype);},bV);bW.ofSeqNonCopying=function(cw){var cx,cy;if(cw instanceof a.Array)return cw;else if(cw instanceof v)return P.ofList(cw);else if(cw===null)return[];else{cx=[];cy=bn.Get(cw);try{while(cy.MoveNext())cx.push(cy.Current());return cx;}finally{if(typeof cy=="object"&&"Dispose"in cy)cy.Dispose();}}};bW.TreeReduce=function(cw,cx,cy){var cz;function cA(cB,cC){var cD,cE;return cC<=0?cw:cC===1&&(cB>=0&&cB<cz)?P.get(cy,cB):(cE=cC/2>>0,cx(cA(cB,cE),cA(cB+cE,cC-cE)));}cz=P.length(cy);return cA(0,cz);};bW.mapInPlace=function(cw,cx){var cy,cz;for(cy=0,cz=cx.length-1;cy<=cz;cy++)cx[cy]=cw(cx[cy]);return cx;};bW.MapTreeReduce=function(cw,cx,cy,cz){var cA;function cB(cC,cD){var cE,cF;return cD<=0?cx:cD===1&&(cC>=0&&cC<cA)?cw(P.get(cz,cC)):(cF=cD/2>>0,cy(cB(cC,cF),cB(cC+cF,cD-cF)));}cA=P.length(cz);return cB(0,cA);};bX=_8.FSharpMap=cs.Class({Equals:function(cw){return this.get_Count()===cw.get_Count()&&_1.forall2(I.Equals,this,cw);},GetEnumerator$1:function(){return bn.Get(_1.map(function(cw){return{K:cw.Key,V:cw.Value};},b8.Enumerate(false,this.tree)));},get_Count:function(){var cw;cw=this.tree;return cw==null?0:cw.Count;},GetHashCode:function(){return I.Hash(P.ofSeq(this));},Add:function(cw,cx){return new bX.New$1(b8.Add(b_.New(cw,cx),this.tree));},get_IsEmpty:function(){return this.tree==null;},get_Tree:function(){return this.tree;},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(cw){return _1.compareWith(I.Compare,this,cw);}},r,bX);bX.New=cs.Ctor(function(cw){bX.New$1.call(this,cj.fromSeq(cw));},bX);bX.New$1=cs.Ctor(function(cw){r.New.call(this);this.tree=cw;},bX);bY.OfArray=function(cw){return new bX.New$1(b8.OfSeq(_1.map(function(cx){return b_.New(cx[0],cx[1]);},cw)));};bY.FoldBack=function(cw,cx,cy){return _1.fold(function(cz,cA){return cw(cA.Key,cA.Value,cz);},cy,b8.Enumerate(true,cx.get_Tree()));};bY.ToSeq=function(cw){return _1.map(function(cx){return[cx.Key,cx.Value];},b8.Enumerate(false,cw.get_Tree()));};bZ.$cctor=function(){bZ.$cctor=a.ignore;bZ.counter=0;};b1.New=function(cw,cx){return{PreviousNodes:cw,Top:cx};};b2.get_Empty=function(){return{$:0,$0:new bv.New$3()};};b2.FindAll=function(cw){var cx;function cy(cA){if(cA!=null&&cA.$==0){cy(cA.$0);cy(cA.$1);}else if(cA!=null&&cA.$==1)cz(cA.$0);else if(cA!=null&&cA.$==2)cy(cA.$0.Current);else if(cA!=null&&cA.$==6)P.iter(cz,cA.$0.Holes);}function cz(cA){cx.push(cA);cy(cA.Children);}cx=[];cy(cw);return{$:0,$0:new bv.New$2(cx)};};b2.Filter=function(cw,cx){return{$:0,$0:cl.Filter(cw,cx.$0)};};b2.Except=function(cw,cx){return{$:0,$0:cl.Except(cw.$0,cx.$0)};};b2.ToArray=function(cw){return cl.ToArray(cw.$0);};b2.Intersect=function(cw,cx){return{$:0,$0:cl.Intersect(cw.$0,cx.$0)};};b3.UseAnimations=function(){cb.$cctor();return cb.UseAnimations;};b3.Actions=function(cw){return b3.ConcatActions(P.choose(function(cx){return cx.$==1?{$:1,$0:cx.$0}:null;},cc.ToArray(cw.$0)));};b3.Finalize=function(cw){P.iter(function(cx){if(cx.$==0)cx.$0();},cc.ToArray(cw.$0));};b3.ConcatActions=function(cw){var cx,cy,cz,cA;cx=bW.ofSeqNonCopying(cw);cy=P.length(cx);return cy===0?b3.Const():cy===1?P.get(cx,0):(cz=_1.max(_1.map(function(cB){return cB.Duration;},cx)),(cA=P.map(function(cB){return b3.Prolong(cz,cB);},cx),b3.Def(cz,function(cB){P.iter(function(cC){cC.Compute(cB);},cA);})));};b3.List=function(cw){return cw.$0;};b3.Const=function(cw){return b3.Def(0,function(){return cw;});};b3.Def=function(cw,cx){return{Compute:cx,Duration:cw};};b3.Prolong=function(cw,cx){var cy,cz,cA;cy=cx.Compute;cz=cx.Duration;cA=J.Create(function(){return cx.Compute(cx.Duration);});return{Compute:function(cB){return cB>=cz?cA.f():cy(cB);},Duration:cw};};b4.$cctor=function(){b4.$cctor=a.ignore;b4.BatchUpdatesEnabled=true;};b5.$cctor=function(){b5.$cctor=a.ignore;b5.noneCT=bQ.New(false,[]);b5.scheduler=new b6.New();b5.defCTS=[new ce.New()];b5.Zero=by.Return();b5.GetCT=function(cw){cw.k({$:0,$0:cw.ct});};};b6=by.Scheduler=cs.Class({Fork:function(cw){var cx;cx=this;this.robin.push(cw);this.idle?(this.idle=false,a.setTimeout(function(){cx.tick();},0)):void 0;},tick:function(){var cw,cx,cy;cx=this;cy=cv.now();cw=true;while(cw)if(this.robin.length===0){this.idle=true;cw=false;}else{(this.robin.shift())();cv.now()-cy>40?(a.setTimeout(function(){cx.tick();},0),cw=false):void 0;}}},r,b6);b6.New=cs.Ctor(function(){r.New.call(this);this.idle=true;this.robin=[];},b6);b7.$cctor=function(){var cw,cx,cy,cz,cA,cB,cC,cD,cE,cF;b7.$cctor=a.ignore;b7.EmptyAttr=null;b7.BoolCheckedApply=cs.Curried3(function(cG,cH,cI){return[cH(function(cJ){cJ.addEventListener("change",function(){return!I.Equals(cG.Get(),cJ.checked)?cG.Set(cJ.checked):null;});}),cI(function(cJ){return function(cK){cJ.checked=cK;};})];});b7.StringSet=function(cG){return function(cH){cG.value=cH;};};b7.StringGet=function(cG){return{$:1,$0:cG.value};};b7.StringApply=(cw=cf.StringGet(),(cx=cf.StringSet(),cs.Curried(cf.ApplyValue,3,[cw,function(cG,cH){return(cx(cG))(cH);}])));b7.IntSetUnchecked=function(cG){return function(cH){cG.value=a.String(cH);};};b7.IntGetUnchecked=function(cG){var cH,cI;cH=cG.value;return cg.isBlank(cH)?{$:1,$0:0}:(cI=+cH,cI!==cI>>0?null:{$:1,$0:cI});};b7.IntApplyUnchecked=(cy=cf.IntGetUnchecked(),(cz=cf.IntSetUnchecked(),cs.Curried(cf.ApplyValue,3,[cy,function(cG,cH){return(cz(cG))(cH);}])));b7.IntSetChecked=function(cG){return function(cH){var cI;cI=cH.get_Input();return cG.value!==cI?void(cG.value=cI):null;};};b7.IntGetChecked=function(cG){var cH,cI,cJ;cH=cG.value;return{$:1,$0:cg.isBlank(cH)?(cG.checkValidity?cG.checkValidity():true)?new bE({$:2,$0:cH}):new bE({$:1,$0:cH}):(cI=(cJ=0,[z.TryParseInt32(cH,{get:function(){return cJ;},set:function(cK){cJ=cK;}}),cJ]),cI[0]?new bE({$:0,$0:cI[1],$1:cH}):new bE({$:1,$0:cH}))};};b7.IntApplyChecked=(cA=cf.IntGetChecked(),(cB=cf.IntSetChecked(),cs.Curried(cf.ApplyValue,3,[cA,function(cG,cH){return(cB(cG))(cH);}])));b7.FloatSetUnchecked=function(cG){return function(cH){cG.value=a.String(cH);};};b7.FloatGetUnchecked=function(cG){var cH,cI;cH=cG.value;return cg.isBlank(cH)?{$:1,$0:0}:(cI=+cH,a.isNaN(cI)?null:{$:1,$0:cI});};b7.FloatApplyUnchecked=(cC=cf.FloatGetUnchecked(),(cD=cf.FloatSetUnchecked(),cs.Curried(cf.ApplyValue,3,[cC,function(cG,cH){return(cD(cG))(cH);}])));b7.FloatSetChecked=function(cG){return function(cH){var cI;cI=cH.get_Input();return cG.value!==cI?void(cG.value=cI):null;};};b7.FloatGetChecked=function(cG){var cH,cI;cH=cG.value;return{$:1,$0:cg.isBlank(cH)?(cG.checkValidity?cG.checkValidity():true)?new bE({$:2,$0:cH}):new bE({$:1,$0:cH}):(cI=+cH,a.isNaN(cI)?new bE({$:1,$0:cH}):new bE({$:0,$0:cI,$1:cH}))};};b7.FloatApplyChecked=(cE=cf.FloatGetChecked(),(cF=cf.FloatSetChecked(),cs.Curried(cf.ApplyValue,3,[cE,function(cG,cH){return(cF(cG))(cH);}])));};b9.New=function(cw,cx,cy,cz,cA){return{Node:cw,Left:cx,Right:cy,Height:cz,Count:cA};};b_=_8.Pair=cs.Class({Equals:function(cw){return I.Equals(this.Key,cw.Key);},GetHashCode:function(){return I.Hash(this.Key);},CompareTo0:function(cw){return I.Compare(this.Key,cw.Key);}},null,b_);b_.New=function(cw,cx){return new b_({Key:cw,Value:cx});};b$.WriteLink=function(cw,cx){var cy;cy=cx.get_IsEmpty()?"":"?"+b$.WriteQuery(cx);return"/"+b$.Concat(cw)+cy;};b$.Concat=function(cw){var cx,cy;cx=[];cy=true;u.iter(function(cz){if(!X.IsNullOrEmpty(cz)){cy?cy=false:cx.push("/");cx.push(cz);}},cw);return X.Join("",P.ofSeq(cx));};b$.WriteQuery=function(cw){function cx(cy,cz){return cy+"="+cz;}return X.concat("&",_1.map(function(cy){return cx(cy[0],cy[1]);},bY.ToSeq(cw)));};ca.$cctor=function(){var cw;ca.$cctor=a.ignore;ca.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");ca.rtagName=new a.RegExp("<([\\w:]+)");ca.rhtml=new a.RegExp("<|&#?\\w+;");ca.wrapMap=(cw=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:cw,tbody:cw,tfoot:cw,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});ca.defaultWrap=[0,"",""];};cb.$cctor=function(){cb.$cctor=a.ignore;cb.CubicInOut=ck.Custom(function(cw){var cx;cx=cw*cw;return 3*cx-2*(cx*cw);});cb.UseAnimations=true;};cc.Append=function(cw,cx){return cw.$==0?cx:cx.$==0?cw:{$:2,$0:cw,$1:cx};};cc.ToArray=function(cw){var cx;function cy(cz){if(cz.$==1)cx.push(cz.$0);else if(cz.$==2){cy(cz.$0);cy(cz.$1);}else if(cz.$==3)P.iter(function(cA){cx.push(cA);},cz.$0);}cx=[];cy(cw);return cx.slice(0);};cc.Concat=function(cw){var cx;cx=bW.ofSeqNonCopying(cw);return bW.TreeReduce(cc.Empty(),cc.Append,cx);};cc.Empty=function(){cp.$cctor();return cp.Empty;};cd.concat=function(cw){var cx,cy;cx=[];for(var cz in cw)cx.push.apply(cx,cw[cz]);return cx;};ce=d.CancellationTokenSource=cs.Class({},r,ce);ce.New=cs.Ctor(function(){r.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},ce);cf.ApplyValue=function(cw,cx,cy,cz,cA){return[cz(function(cB){function cC(){cy.UpdateMaybe(function(cD){var cE,cF;cE=cw(cB);return cE!=null&&cE.$==1&&(!I.Equals(cE.$0,cD)&&(cF=[cE,cE.$0],true))?cF[0]:null;});}cB.addEventListener("change",cC);cB.addEventListener("input",cC);cB.addEventListener("keypress",cC);}),cA(function(cB){return function(cC){var cD,cE;cD=cw(cB);return cD!=null&&cD.$==1&&(I.Equals(cD.$0,cC)&&(cE=cD.$0,true))?null:cx(cB,cC);};})];};cf.StringSet=function(){b7.$cctor();return b7.StringSet;};cf.StringGet=function(){b7.$cctor();return b7.StringGet;};cf.IntSetUnchecked=function(){b7.$cctor();return b7.IntSetUnchecked;};cf.IntGetUnchecked=function(){b7.$cctor();return b7.IntGetUnchecked;};cf.IntSetChecked=function(){b7.$cctor();return b7.IntSetChecked;};cf.IntGetChecked=function(){b7.$cctor();return b7.IntGetChecked;};cf.FloatSetUnchecked=function(){b7.$cctor();return b7.FloatSetUnchecked;};cf.FloatGetUnchecked=function(){b7.$cctor();return b7.FloatGetUnchecked;};cf.FloatSetChecked=function(){b7.$cctor();return b7.FloatSetChecked;};cf.FloatGetChecked=function(){b7.$cctor();return b7.FloatGetChecked;};cf.StringApply=function(){b7.$cctor();return b7.StringApply;};cf.BoolCheckedApply=function(){b7.$cctor();return b7.BoolCheckedApply;};cf.IntApplyChecked=function(){b7.$cctor();return b7.IntApplyChecked;};cf.IntApplyUnchecked=function(){b7.$cctor();return b7.IntApplyUnchecked;};cf.FloatApplyChecked=function(){b7.$cctor();return b7.FloatApplyChecked;};cf.FloatApplyUnchecked=function(){b7.$cctor();return b7.FloatApplyUnchecked;};cg.isBlank=function(cw){return X.forall(cm.IsWhiteSpace,cw);};ch=_8.ValueCollection=cs.Class({GetEnumerator$1:function(){return bn.Get(_1.map(function(cw){return cw.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},r,ch);ch.New=cs.Ctor(function(cw){r.New.call(this);this.d=cw;},ch);ci.Clear=function(cw){cw.splice(0,P.length(cw));};cj.fromSeq=function(cw){var cx;cx=P.ofSeq(_1.delay(function(){return _1.collect(function(cy){return[b_.New(cy[0],cy[1])];},_1.distinctBy(function(cy){return cy[0];},cw));}));P.sortInPlace(cx);return b8.Build(cx,0,cx.length-1);};ck=x.Easing=cs.Class({},r,ck);ck.Custom=function(cw){return new ck.New(cw);};ck.New=cs.Ctor(function(cw){r.New.call(this);this.transformTime=cw;},ck);cl.Filter=function(cw,cx){return new bv.New$2(P.filter(cw,cl.ToArray(cx)));};cl.Except=function(cw,cx){var cy;cy=new bv.New$2(cl.ToArray(cx));cy.ExceptWith(cl.ToArray(cw));return cy;};cl.ToArray=function(cw){var cx;cx=P.create(cw.get_Count(),void 0);cw.CopyTo(cx);return cx;};cl.Intersect=function(cw,cx){var cy;cy=new bv.New$2(cl.ToArray(cw));cy.IntersectWith(cl.ToArray(cx));return cy;};b8.OfSeq=function(cw){var cx;cx=P.ofSeq(_1.distinct(cw));P.sortInPlace(cx);return b8.Build(cx,0,cx.length-1);};b8.Enumerate=function(cw,cx){function cy(cz,cA){var cB;while(true)if(cz==null)return cA.$==1?{$:1,$0:[cA.$0[0],[cA.$0[1],cA.$1]]}:null;else if(cw){cB=cz;cz=cB.Right;cA=new v({$:1,$0:[cB.Node,cB.Left],$1:cA});}else{cB=cz;cz=cB.Left;cA=new v({$:1,$0:[cB.Node,cB.Right],$1:cA});}}return _1.unfold(function(cz){return cy(cz[0],cz[1]);},[cx,v.Empty]);};b8.Build=function(cw,cx,cy){var cz,cA,cB;return cy-cx+1<=0?null:(cz=(cx+cy)/2>>0,(cA=b8.Build(cw,cx,cz-1),(cB=b8.Build(cw,cz+1,cy),b8.Branch(P.get(cw,cz),cA,cB))));};b8.Add=function(cw,cx){return b8.Put(function(cy,cz){return cz;},cw,cx);};b8.Branch=function(cw,cx,cy){var cz,cA;return b9.New(cw,cx,cy,1+(cz=cx==null?0:cx.Height,(cA=cy==null?0:cy.Height,I.Compare(cz,cA)===1?cz:cA)),1+(cx==null?0:cx.Count)+(cy==null?0:cy.Count));};b8.Put=function(cw,cx,cy){var cz,cA;cz=b8.Lookup(cx,cy);cA=cz[0];return cA==null?b8.Rebuild(cz[1],b8.Branch(cx,null,null)):b8.Rebuild(cz[1],b8.Branch(cw(cA.Node,cx),cA.Left,cA.Right));};b8.Lookup=function(cw,cx){var cy,cz,cA,cB;cy=[];cz=cx;cA=true;while(cA)if(cz==null)cA=false;else{cB=I.Compare(cw,cz.Node);cB===0?cA=false:cB===1?(cy.unshift([true,cz.Node,cz.Left]),cz=cz.Right):(cy.unshift([false,cz.Node,cz.Right]),cz=cz.Left);}return[cz,cy];};b8.Rebuild=function(cw,cx){var cy,cA,cB,cC,cD,cE,cF,cG,cH,cI;function cz(cJ){return cJ==null?0:cJ.Height;}cy=cx;for(cA=0,cB=P.length(cw)-1;cA<=cB;cA++){cy=(cC=P.get(cw,cA),cC[0]?(cD=cC[1],(cE=cC[2],cz(cy)>cz(cE)+1?cz(cy.Left)===cz(cy.Right)+1?(cF=cy.Left,b8.Branch(cF.Node,b8.Branch(cD,cE,cF.Left),b8.Branch(cy.Node,cF.Right,cy.Right))):b8.Branch(cy.Node,b8.Branch(cD,cE,cy.Left),cy.Right):b8.Branch(cD,cE,cy))):(cG=cC[1],(cH=cC[2],cz(cy)>cz(cH)+1?cz(cy.Right)===cz(cy.Left)+1?(cI=cy.Right,b8.Branch(cI.Node,b8.Branch(cy.Node,cy.Left,cI.Left),b8.Branch(cG,cI.Right,cH))):b8.Branch(cy.Node,cy.Left,b8.Branch(cG,cy.Right,cH)):b8.Branch(cG,cy,cH))));}return cy;};cm.IsWhiteSpace=function(cw){return cw.match(new a.RegExp("\\s"))!==null;};z.TryParse=function(cw,cx,cy,cz){var cA,cB;cA=+cw;cB=cA===cA-cA%1&&cA>=cx&&cA<=cy;cB?cz.set(cA):void 0;return cB;};cn.Children=function(cw,cx){var cy,cz,cA;if(cx!=null&&cx.$==1){cA=[];cy=cx.$0[0].nextSibling;while(cy!==cx.$0[1]){cA.push(cy);cy=cy.nextSibling;}return{$:0,$0:cA};}else return{$:0,$0:P.init(cw.childNodes.length,(cz=cw.childNodes,function(cB){return cz[cB];}))};};cn.Except=function(cw,cx){var cy;cy=cw.$0;return{$:0,$0:P.filter(function(cz){return P.forall(function(cA){return!(cz===cA);},cy);},cx.$0)};};cn.Iter=function(cw,cx){P.iter(cw,cx.$0);};cn.DocChildren=function(cw){var cx;function cy(cz){if(cz!=null&&cz.$==2)cy(cz.$0.Current);else if(cz!=null&&cz.$==1)cx.push(cz.$0.El);else if(cz==null);else if(cz!=null&&cz.$==5)cx.push(cz.$0);else if(cz!=null&&cz.$==4)cx.push(cz.$0.Text);else if(cz!=null&&cz.$==6)P.iter(function(cA){if(cA==null||cA.constructor===_6)cy(cA);else cx.push(cA);},cz.$0.Els);else{cy(cz.$0);cy(cz.$1);}}cx=[];cy(cw.Children);return{$:0,$0:bW.ofSeqNonCopying(cx)};};co=d.OperationCanceledException=cs.Class({},bU,co);co.New=cs.Ctor(function(cw){co.New$1.call(this,"The operation was canceled.",null,cw);},co);co.New$1=cs.Ctor(function(cw,cx,cy){this.message=cw;this.inner=cx;_6.setPrototypeOf(this,co.prototype);this.ct=cy;},co);cp.$cctor=function(){cp.$cctor=a.ignore;cp.Empty={$:0};};cs.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
